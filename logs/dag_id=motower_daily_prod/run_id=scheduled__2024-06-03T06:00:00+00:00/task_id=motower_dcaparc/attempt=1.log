[2024-07-24T23:27:47.888+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-07-24T23:27:48.089+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [queued]>
[2024-07-24T23:27:48.097+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [queued]>
[2024-07-24T23:27:48.098+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-07-24T23:27:48.110+0000] {taskinstance.py:2330} INFO - Executing <Task(PythonOperator): motower_dcaparc> on 2024-06-03 06:00:00+00:00
[2024-07-24T23:27:48.118+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:62: DeprecationWarning: This process (pid=1456) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-07-24T23:27:48.119+0000] {standard_task_runner.py:64} INFO - Started process 1465 to run task
[2024-07-24T23:27:48.120+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'motower_daily_prod', 'motower_dcaparc', 'scheduled__2024-06-03T06:00:00+00:00', '--job-id', '555', '--raw', '--subdir', 'DAGS_FOLDER/gps/custom_dags/motower_daily.py', '--cfg-path', '/tmp/tmpcmtisda8']
[2024-07-24T23:27:48.122+0000] {standard_task_runner.py:91} INFO - Job 555: Subtask motower_dcaparc
[2024-07-24T23:27:48.159+0000] {task_command.py:426} INFO - Running <TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [running]> on host b3845fb494d4
[2024-07-24T23:27:48.230+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_EMAIL='richmond.kongo@orange.com,assane.diop@orange.com,cyrille1.danho@orange.com,mohamed2.sylla@orange.com,amadou.diomande@orange.com,Jonas.kouame@orange.com,armand.kablan@orange.com,anicet.azombade@orange.com,etienne.kouadio@orange.com,bertine.kouakou@orange.com,florentine.kouakou@orange.com,ange.phaceli@orange.com,soulegame.soro@orange.com,innocent.yengo@orange.com' AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='motower_daily_prod' AIRFLOW_CTX_TASK_ID='motower_dcaparc' AIRFLOW_CTX_EXECUTION_DATE='2024-06-03T06:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-06-03T06:00:00+00:00'
[2024-07-24T23:27:48.231+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-07-24T23:27:48.244+0000] {motower_daily.py:109} INFO - get last modified bdd sites cleaned
[2024-07-24T23:27:48.253+0000] {motower_daily.py:120} INFO - READING BASE_SITES-cleaned/2024/06/02.csv
[2024-07-24T23:27:48.293+0000] {data_validation.py:28} INFO - START VALIDATION 
[2024-07-24T23:27:48.294+0000] {data_validation.py:40} INFO - VALID ACTIFS SITES 3107
[2024-07-24T23:27:48.295+0000] {motower_daily.py:130} INFO - GET CA PARC FILE OF THE DAY 2024-06-02
[2024-07-24T23:27:48.295+0000] {motower_daily.py:134} INFO - READING ca-parc/2024/06/02.csv
[2024-07-24T23:27:48.313+0000] {motower_daily.py:139} INFO - DAILY KPI -      day_id       ca_voix       ca_data      parc  parc_data   parc_2g  parc_3g  parc_4g  parc_5g  parc_other      ca_total
0  20240602  4.822626e+08  7.120804e+08  16714097    9177438  12057840   876499  5949531   319188     1385238  1.241494e+09
[2024-07-24T23:27:48.314+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_total
[2024-07-24T23:27:48.315+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_total ARE VALID
[2024-07-24T23:27:48.315+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_voix
[2024-07-24T23:27:48.315+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_voix ARE VALID
[2024-07-24T23:27:48.315+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_data
[2024-07-24T23:27:48.316+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_data ARE VALID
[2024-07-24T23:27:48.316+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc
[2024-07-24T23:27:48.316+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc ARE VALID
[2024-07-24T23:27:48.317+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_data
[2024-07-24T23:27:48.317+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_data ARE VALID
[2024-07-24T23:27:48.317+0000] {motower_daily.py:142} INFO - MERGING BDD AND CA
[2024-07-24T23:27:48.320+0000] {motower_daily.py:144} INFO - prepare final daily data
[2024-07-24T23:27:48.320+0000] {logging_mixin.py:188} INFO - Index(['site', 'site bts', 'site physique', 'code oci', 'gestionnaire',
       'proprietaire', 'autre code', 'code esco', 'code ihs', 'longitude',
       'latitude', 'type du site', 'statut', 'couche en service',
       'technologie sans tdd', 'technologie', 'date mes 2g', 'date mes',
       'date mes 3g', 'date mes 4g', 'annee construction pylone',
       'statut sharing', 'statut proprietaire', 'statut partage',
       'geo localite', 'commune', 'departement', 'region', 'district',
       'partenaires', 'localisation', 'equipementier telecom', 'ville',
       'quartier', 'type baie', 'hauteur batiment', 'tower type',
       'tower location', 'type geolocalite', 'tower height', 'type site ihs',
       'type energie', 'projet', 'id quartier', 'id geolocalite', 'clutter',
       'position site', 'type indoor', 'decoupage', 'sous coloc', 'tenant',
       'type de cable', 'mois', 'code oci id', 'day_id', 'id_site', 'ca_voix',
       'ca_data', 'ca_total', 'trafic_voix_in', 'trafic_data_in', 'parc',
       'parc_data', 'parc_2g', 'parc_3g', 'parc_4g', 'parc_5g', 'parc_other',
       'jour'],
      dtype='object')
[2024-07-24T23:27:48.322+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:151: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final.rename(columns=DAILY_CAPARC_COL, inplace=True)

[2024-07-24T23:27:48.323+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:152: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["trafic_data_in_mo"] = df_final["trafic_data_in"] / 1000

[2024-07-24T23:27:48.323+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:153: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["ca_norm"] = None

[2024-07-24T23:27:48.324+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:154: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["ca_mtd"] = None

[2024-07-24T23:27:48.324+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:155: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["segment"] = None

[2024-07-24T23:27:48.324+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:156: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["previous_segment"] = None

[2024-07-24T23:27:48.325+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:157: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["evolution_segment"] = None

[2024-07-24T23:27:48.325+0000] {logging_mixin.py:188} INFO - 6
[2024-07-24T23:27:48.332+0000] {motower_daily.py:193} INFO - ADD  SEGMENT
[2024-07-24T23:27:48.476+0000] {motower_daily.py:198} INFO - DATA VALIDATION AFTER MERGING
[2024-07-24T23:27:48.476+0000] {data_validation.py:28} INFO - START VALIDATION 
[2024-07-24T23:27:48.477+0000] {data_validation.py:40} INFO - VALID ACTIFS SITES 3107
[2024-07-24T23:27:48.484+0000] {motower_daily.py:209} INFO - DAILY KPI -         jour       ca_voix      ca_data  parc_global  parc_data    parc_2g   parc_3g    parc_4g   parc_5g  autre_parc      ca_total
0 2024-06-02  4.705111e+08  699688383.6   14776871.0  8935471.0  3821885.0  122369.0  3167222.0  214239.0    447997.0  1.215856e+09
[2024-07-24T23:27:48.484+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_total
[2024-07-24T23:27:48.484+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_total ARE VALID
[2024-07-24T23:27:48.485+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_voix
[2024-07-24T23:27:48.485+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_voix ARE VALID
[2024-07-24T23:27:48.485+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_data
[2024-07-24T23:27:48.486+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_data ARE VALID
[2024-07-24T23:27:48.486+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_global
[2024-07-24T23:27:48.486+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_global ARE VALID
[2024-07-24T23:27:48.487+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_data
[2024-07-24T23:27:48.487+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_data ARE VALID
[2024-07-24T23:27:48.510+0000] {logging_mixin.py:188} INFO -         jour code_oci  ...  previous_segment evolution_segment
0 2024-06-02  OCI2831  ...              None              None
1 2024-06-02  OCI3257  ...              None              None
2 2024-06-02  OCI3428  ...              None              None
3 2024-06-02  OCI2587  ...              None              None
4 2024-06-02  OCI3260  ...              None              None

[5 rows x 38 columns]
[2024-07-24T23:27:48.535+0000] {logging_mixin.py:188} INFO -         jour code_oci  ...  previous_segment evolution_segment
0 2024-06-02  OCI2831  ...              None              None
1 2024-06-02  OCI3257  ...              None              None
2 2024-06-02  OCI3428  ...              None              None
3 2024-06-02  OCI2587  ...              None              None
4 2024-06-02  OCI3260  ...              None              None

[5 rows x 38 columns]
[2024-07-24T23:27:48.935+0000] {python.py:237} INFO - Done. Returned value was: None
[2024-07-24T23:27:48.936+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-07-24T23:27:48.947+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=motower_daily_prod, task_id=motower_dcaparc, run_id=scheduled__2024-06-03T06:00:00+00:00, execution_date=20240603T060000, start_date=20240724T232748, end_date=20240724T232748
[2024-07-24T23:27:48.975+0000] {local_task_job_runner.py:243} INFO - Task exited with return code 0
[2024-07-24T23:27:48.994+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-24T23:27:48.996+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-07-25T08:32:33.924+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-07-25T08:32:34.210+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [queued]>
[2024-07-25T08:32:34.227+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [queued]>
[2024-07-25T08:32:34.227+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-07-25T08:32:34.244+0000] {taskinstance.py:2330} INFO - Executing <Task(PythonOperator): motower_dcaparc> on 2024-06-03 06:00:00+00:00
[2024-07-25T08:32:34.257+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:62: DeprecationWarning: This process (pid=1962) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-07-25T08:32:34.259+0000] {standard_task_runner.py:64} INFO - Started process 1978 to run task
[2024-07-25T08:32:34.260+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'motower_daily_prod', 'motower_dcaparc', 'scheduled__2024-06-03T06:00:00+00:00', '--job-id', '689', '--raw', '--subdir', 'DAGS_FOLDER/gps/custom_dags/motower_daily.py', '--cfg-path', '/tmp/tmpgi756xdc']
[2024-07-25T08:32:34.262+0000] {standard_task_runner.py:91} INFO - Job 689: Subtask motower_dcaparc
[2024-07-25T08:32:34.327+0000] {task_command.py:426} INFO - Running <TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [running]> on host b3845fb494d4
[2024-07-25T08:32:34.451+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_EMAIL='richmond.kongo@orange.com,assane.diop@orange.com,cyrille1.danho@orange.com,mohamed2.sylla@orange.com,amadou.diomande@orange.com,Jonas.kouame@orange.com,armand.kablan@orange.com,anicet.azombade@orange.com,etienne.kouadio@orange.com,bertine.kouakou@orange.com,florentine.kouakou@orange.com,ange.phaceli@orange.com,soulegame.soro@orange.com,innocent.yengo@orange.com' AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='motower_daily_prod' AIRFLOW_CTX_TASK_ID='motower_dcaparc' AIRFLOW_CTX_EXECUTION_DATE='2024-06-03T06:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-06-03T06:00:00+00:00'
[2024-07-25T08:32:34.452+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-07-25T08:32:34.471+0000] {motower_daily.py:109} INFO - get last modified bdd sites cleaned
[2024-07-25T08:32:34.484+0000] {motower_daily.py:120} INFO - READING BASE_SITES-cleaned/2024/06/02.csv
[2024-07-25T08:32:34.557+0000] {data_validation.py:28} INFO - START VALIDATION 
[2024-07-25T08:32:34.559+0000] {data_validation.py:40} INFO - VALID ACTIFS SITES 3107
[2024-07-25T08:32:34.560+0000] {motower_daily.py:130} INFO - GET CA PARC FILE OF THE DAY 2024-06-02
[2024-07-25T08:32:34.560+0000] {motower_daily.py:134} INFO - READING ca-parc/2024/06/02.csv
[2024-07-25T08:32:34.588+0000] {motower_daily.py:139} INFO - DAILY KPI -      day_id       ca_voix       ca_data      parc  parc_data   parc_2g  parc_3g  parc_4g  parc_5g  parc_other      ca_total
0  20240602  4.822626e+08  7.120804e+08  16714097    9177438  12057840   876499  5949531   319188     1385238  1.241494e+09
[2024-07-25T08:32:34.589+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_total
[2024-07-25T08:32:34.590+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_total ARE VALID
[2024-07-25T08:32:34.590+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_voix
[2024-07-25T08:32:34.591+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_voix ARE VALID
[2024-07-25T08:32:34.592+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_data
[2024-07-25T08:32:34.592+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_data ARE VALID
[2024-07-25T08:32:34.593+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc
[2024-07-25T08:32:34.593+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc ARE VALID
[2024-07-25T08:32:34.594+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_data
[2024-07-25T08:32:34.595+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_data ARE VALID
[2024-07-25T08:32:34.595+0000] {motower_daily.py:142} INFO - MERGING BDD AND CA
[2024-07-25T08:32:34.600+0000] {motower_daily.py:144} INFO - prepare final daily data
[2024-07-25T08:32:34.602+0000] {logging_mixin.py:188} INFO - Index(['site', 'site bts', 'site physique', 'code oci', 'gestionnaire',
       'proprietaire', 'autre code', 'code esco', 'code ihs', 'longitude',
       'latitude', 'type du site', 'statut', 'couche en service',
       'technologie sans tdd', 'technologie', 'date mes 2g', 'date mes',
       'date mes 3g', 'date mes 4g', 'annee construction pylone',
       'statut sharing', 'statut proprietaire', 'statut partage',
       'geo localite', 'commune', 'departement', 'region', 'district',
       'partenaires', 'localisation', 'equipementier telecom', 'ville',
       'quartier', 'type baie', 'hauteur batiment', 'tower type',
       'tower location', 'type geolocalite', 'tower height', 'type site ihs',
       'type energie', 'projet', 'id quartier', 'id geolocalite', 'clutter',
       'position site', 'type indoor', 'decoupage', 'sous coloc', 'tenant',
       'type de cable', 'mois', 'code oci id', 'day_id', 'id_site', 'ca_voix',
       'ca_data', 'ca_total', 'trafic_voix_in', 'trafic_data_in', 'parc',
       'parc_data', 'parc_2g', 'parc_3g', 'parc_4g', 'parc_5g', 'parc_other',
       'jour'],
      dtype='object')
[2024-07-25T08:32:34.605+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:151: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final.rename(columns=DAILY_CAPARC_COL, inplace=True)

[2024-07-25T08:32:34.606+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:152: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["trafic_data_in_mo"] = df_final["trafic_data_in"] / 1000

[2024-07-25T08:32:34.607+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:153: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["ca_norm"] = None

[2024-07-25T08:32:34.608+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:154: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["ca_mtd"] = None

[2024-07-25T08:32:34.608+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:155: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["segment"] = None

[2024-07-25T08:32:34.609+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:156: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["previous_segment"] = None

[2024-07-25T08:32:34.610+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:157: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["evolution_segment"] = None

[2024-07-25T08:32:34.610+0000] {logging_mixin.py:188} INFO - 6
[2024-07-25T08:32:34.623+0000] {motower_daily.py:193} INFO - ADD  SEGMENT
[2024-07-25T08:32:34.795+0000] {motower_daily.py:198} INFO - DATA VALIDATION AFTER MERGING
[2024-07-25T08:32:34.796+0000] {data_validation.py:28} INFO - START VALIDATION 
[2024-07-25T08:32:34.796+0000] {data_validation.py:40} INFO - VALID ACTIFS SITES 3107
[2024-07-25T08:32:34.803+0000] {motower_daily.py:209} INFO - DAILY KPI -         jour       ca_voix      ca_data  parc_global  parc_data    parc_2g   parc_3g    parc_4g   parc_5g  autre_parc      ca_total
0 2024-06-02  4.705111e+08  699688383.6   14776871.0  8935471.0  3821885.0  122369.0  3167222.0  214239.0    447997.0  1.215856e+09
[2024-07-25T08:32:34.803+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_total
[2024-07-25T08:32:34.804+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_total ARE VALID
[2024-07-25T08:32:34.804+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_voix
[2024-07-25T08:32:34.804+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_voix ARE VALID
[2024-07-25T08:32:34.805+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_data
[2024-07-25T08:32:34.805+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_data ARE VALID
[2024-07-25T08:32:34.805+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_global
[2024-07-25T08:32:34.806+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_global ARE VALID
[2024-07-25T08:32:34.806+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_data
[2024-07-25T08:32:34.806+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_data ARE VALID
[2024-07-25T08:32:34.829+0000] {logging_mixin.py:188} INFO -         jour code_oci  ...  previous_segment evolution_segment
0 2024-06-02  OCI2831  ...              None              None
1 2024-06-02  OCI3257  ...              None              None
2 2024-06-02  OCI3428  ...              None              None
3 2024-06-02  OCI2587  ...              None              None
4 2024-06-02  OCI3260  ...              None              None

[5 rows x 38 columns]
[2024-07-25T08:32:34.852+0000] {logging_mixin.py:188} INFO -         jour code_oci  ...  previous_segment evolution_segment
0 2024-06-02  OCI2831  ...              None              None
1 2024-06-02  OCI3257  ...              None              None
2 2024-06-02  OCI3428  ...              None              None
3 2024-06-02  OCI2587  ...              None              None
4 2024-06-02  OCI3260  ...              None              None

[5 rows x 38 columns]
[2024-07-25T08:32:35.621+0000] {python.py:237} INFO - Done. Returned value was: None
[2024-07-25T08:32:35.622+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-07-25T08:32:35.633+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=motower_daily_prod, task_id=motower_dcaparc, run_id=scheduled__2024-06-03T06:00:00+00:00, execution_date=20240603T060000, start_date=20240725T083234, end_date=20240725T083235
[2024-07-25T08:32:35.694+0000] {local_task_job_runner.py:243} INFO - Task exited with return code 0
[2024-07-25T08:32:35.720+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-25T08:32:35.722+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-07-25T10:36:12.905+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-07-25T10:36:12.951+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [queued]>
[2024-07-25T10:36:12.970+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [queued]>
[2024-07-25T10:36:12.970+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-07-25T10:36:12.990+0000] {taskinstance.py:2330} INFO - Executing <Task(PythonOperator): motower_dcaparc> on 2024-06-03 06:00:00+00:00
[2024-07-25T10:36:13.007+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:62: DeprecationWarning: This process (pid=5027) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-07-25T10:36:13.009+0000] {standard_task_runner.py:64} INFO - Started process 5042 to run task
[2024-07-25T10:36:13.010+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'motower_daily_prod', 'motower_dcaparc', 'scheduled__2024-06-03T06:00:00+00:00', '--job-id', '1179', '--raw', '--subdir', 'DAGS_FOLDER/gps/custom_dags/motower_daily.py', '--cfg-path', '/tmp/tmp5280hlmi']
[2024-07-25T10:36:13.014+0000] {standard_task_runner.py:91} INFO - Job 1179: Subtask motower_dcaparc
[2024-07-25T10:36:13.163+0000] {task_command.py:426} INFO - Running <TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [running]> on host b3845fb494d4
[2024-07-25T10:36:13.297+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_EMAIL='richmond.kongo@orange.com,assane.diop@orange.com,cyrille1.danho@orange.com,mohamed2.sylla@orange.com,amadou.diomande@orange.com,Jonas.kouame@orange.com,armand.kablan@orange.com,anicet.azombade@orange.com,etienne.kouadio@orange.com,bertine.kouakou@orange.com,florentine.kouakou@orange.com,ange.phaceli@orange.com,soulegame.soro@orange.com,innocent.yengo@orange.com' AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='motower_daily_prod' AIRFLOW_CTX_TASK_ID='motower_dcaparc' AIRFLOW_CTX_EXECUTION_DATE='2024-06-03T06:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-06-03T06:00:00+00:00'
[2024-07-25T10:36:13.298+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-07-25T10:36:13.314+0000] {motower_daily.py:109} INFO - get last modified bdd sites cleaned
[2024-07-25T10:36:13.327+0000] {motower_daily.py:120} INFO - READING BASE_SITES-cleaned/2024/06/02.csv
[2024-07-25T10:36:13.396+0000] {data_validation.py:28} INFO - START VALIDATION 
[2024-07-25T10:36:13.398+0000] {data_validation.py:40} INFO - VALID ACTIFS SITES 3107
[2024-07-25T10:36:13.399+0000] {motower_daily.py:130} INFO - GET CA PARC FILE OF THE DAY 2024-06-02
[2024-07-25T10:36:13.399+0000] {motower_daily.py:134} INFO - READING ca-parc/2024/06/02.csv
[2024-07-25T10:36:13.428+0000] {motower_daily.py:139} INFO - DAILY KPI -      day_id       ca_voix       ca_data      parc  parc_data   parc_2g  parc_3g  parc_4g  parc_5g  parc_other      ca_total
0  20240602  4.822626e+08  7.120804e+08  16714097    9177438  12057840   876499  5949531   319188     1385238  1.241494e+09
[2024-07-25T10:36:13.429+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_total
[2024-07-25T10:36:13.430+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_total ARE VALID
[2024-07-25T10:36:13.430+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_voix
[2024-07-25T10:36:13.434+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_voix ARE VALID
[2024-07-25T10:36:13.435+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_data
[2024-07-25T10:36:13.435+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_data ARE VALID
[2024-07-25T10:36:13.436+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc
[2024-07-25T10:36:13.436+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc ARE VALID
[2024-07-25T10:36:13.437+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_data
[2024-07-25T10:36:13.437+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_data ARE VALID
[2024-07-25T10:36:13.438+0000] {motower_daily.py:142} INFO - MERGING BDD AND CA
[2024-07-25T10:36:13.442+0000] {motower_daily.py:144} INFO - prepare final daily data
[2024-07-25T10:36:13.444+0000] {logging_mixin.py:188} INFO - Index(['site', 'site bts', 'site physique', 'code oci', 'gestionnaire',
       'proprietaire', 'autre code', 'code esco', 'code ihs', 'longitude',
       'latitude', 'type du site', 'statut', 'couche en service',
       'technologie sans tdd', 'technologie', 'date mes 2g', 'date mes',
       'date mes 3g', 'date mes 4g', 'annee construction pylone',
       'statut sharing', 'statut proprietaire', 'statut partage',
       'geo localite', 'commune', 'departement', 'region', 'district',
       'partenaires', 'localisation', 'equipementier telecom', 'ville',
       'quartier', 'type baie', 'hauteur batiment', 'tower type',
       'tower location', 'type geolocalite', 'tower height', 'type site ihs',
       'type energie', 'projet', 'id quartier', 'id geolocalite', 'clutter',
       'position site', 'type indoor', 'decoupage', 'sous coloc', 'tenant',
       'type de cable', 'mois', 'code oci id', 'day_id', 'id_site', 'ca_voix',
       'ca_data', 'ca_total', 'trafic_voix_in', 'trafic_data_in', 'parc',
       'parc_data', 'parc_2g', 'parc_3g', 'parc_4g', 'parc_5g', 'parc_other',
       'jour'],
      dtype='object')
[2024-07-25T10:36:13.446+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:151: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final.rename(columns=DAILY_CAPARC_COL, inplace=True)

[2024-07-25T10:36:13.448+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:152: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["trafic_data_in_mo"] = df_final["trafic_data_in"] / 1000

[2024-07-25T10:36:13.448+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:153: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["ca_norm"] = None

[2024-07-25T10:36:13.449+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:154: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["ca_mtd"] = None

[2024-07-25T10:36:13.449+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:155: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["segment"] = None

[2024-07-25T10:36:13.450+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:156: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["previous_segment"] = None

[2024-07-25T10:36:13.450+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:157: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["evolution_segment"] = None

[2024-07-25T10:36:13.450+0000] {logging_mixin.py:188} INFO - 6
[2024-07-25T10:36:13.466+0000] {motower_daily.py:193} INFO - ADD  SEGMENT
[2024-07-25T10:36:13.692+0000] {motower_daily.py:198} INFO - DATA VALIDATION AFTER MERGING
[2024-07-25T10:36:13.692+0000] {data_validation.py:28} INFO - START VALIDATION 
[2024-07-25T10:36:13.693+0000] {data_validation.py:40} INFO - VALID ACTIFS SITES 3107
[2024-07-25T10:36:13.702+0000] {motower_daily.py:209} INFO - DAILY KPI -         jour       ca_voix      ca_data  parc_global  parc_data    parc_2g   parc_3g    parc_4g   parc_5g  autre_parc      ca_total
0 2024-06-02  4.705111e+08  699688383.6   14776871.0  8935471.0  3821885.0  122369.0  3167222.0  214239.0    447997.0  1.215856e+09
[2024-07-25T10:36:13.703+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_total
[2024-07-25T10:36:13.704+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_total ARE VALID
[2024-07-25T10:36:13.704+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_voix
[2024-07-25T10:36:13.705+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_voix ARE VALID
[2024-07-25T10:36:13.705+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_data
[2024-07-25T10:36:13.706+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_data ARE VALID
[2024-07-25T10:36:13.706+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_global
[2024-07-25T10:36:13.707+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_global ARE VALID
[2024-07-25T10:36:13.707+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_data
[2024-07-25T10:36:13.708+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_data ARE VALID
[2024-07-25T10:36:13.744+0000] {logging_mixin.py:188} INFO -         jour code_oci  ...  previous_segment evolution_segment
0 2024-06-02  OCI2831  ...              None              None
1 2024-06-02  OCI3257  ...              None              None
2 2024-06-02  OCI3428  ...              None              None
3 2024-06-02  OCI2587  ...              None              None
4 2024-06-02  OCI3260  ...              None              None

[5 rows x 38 columns]
[2024-07-25T10:36:13.781+0000] {logging_mixin.py:188} INFO -         jour code_oci  ...  previous_segment evolution_segment
0 2024-06-02  OCI2831  ...              None              None
1 2024-06-02  OCI3257  ...              None              None
2 2024-06-02  OCI3428  ...              None              None
3 2024-06-02  OCI2587  ...              None              None
4 2024-06-02  OCI3260  ...              None              None

[5 rows x 38 columns]
[2024-07-25T10:36:14.636+0000] {python.py:237} INFO - Done. Returned value was: None
[2024-07-25T10:36:14.637+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-07-25T10:36:14.655+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=motower_daily_prod, task_id=motower_dcaparc, run_id=scheduled__2024-06-03T06:00:00+00:00, execution_date=20240603T060000, start_date=20240725T103612, end_date=20240725T103614
[2024-07-25T10:36:14.711+0000] {local_task_job_runner.py:243} INFO - Task exited with return code 0
[2024-07-25T10:36:14.755+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-25T10:36:14.760+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-07-25T11:58:36.097+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-07-25T11:58:36.380+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [queued]>
[2024-07-25T11:58:36.390+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [queued]>
[2024-07-25T11:58:36.390+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-07-25T11:58:36.403+0000] {taskinstance.py:2330} INFO - Executing <Task(PythonOperator): motower_dcaparc> on 2024-06-03 06:00:00+00:00
[2024-07-25T11:58:36.413+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:62: DeprecationWarning: This process (pid=7412) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-07-25T11:58:36.414+0000] {standard_task_runner.py:64} INFO - Started process 7422 to run task
[2024-07-25T11:58:36.415+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'motower_daily_prod', 'motower_dcaparc', 'scheduled__2024-06-03T06:00:00+00:00', '--job-id', '1617', '--raw', '--subdir', 'DAGS_FOLDER/gps/custom_dags/motower_daily.py', '--cfg-path', '/tmp/tmpkwmq1qjr']
[2024-07-25T11:58:36.417+0000] {standard_task_runner.py:91} INFO - Job 1617: Subtask motower_dcaparc
[2024-07-25T11:58:36.486+0000] {task_command.py:426} INFO - Running <TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [running]> on host b3845fb494d4
[2024-07-25T11:58:36.610+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_EMAIL='richmond.kongo@orange.com,assane.diop@orange.com,cyrille1.danho@orange.com,mohamed2.sylla@orange.com,amadou.diomande@orange.com,Jonas.kouame@orange.com,armand.kablan@orange.com,anicet.azombade@orange.com,etienne.kouadio@orange.com,bertine.kouakou@orange.com,florentine.kouakou@orange.com,ange.phaceli@orange.com,soulegame.soro@orange.com,innocent.yengo@orange.com' AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='motower_daily_prod' AIRFLOW_CTX_TASK_ID='motower_dcaparc' AIRFLOW_CTX_EXECUTION_DATE='2024-06-03T06:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-06-03T06:00:00+00:00'
[2024-07-25T11:58:36.611+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-07-25T11:58:36.686+0000] {motower_daily.py:109} INFO - get last modified bdd sites cleaned
[2024-07-25T11:58:36.714+0000] {motower_daily.py:120} INFO - READING BASE_SITES-cleaned/2024/06/02.csv
[2024-07-25T11:58:36.793+0000] {data_validation.py:28} INFO - START VALIDATION 
[2024-07-25T11:58:36.796+0000] {data_validation.py:40} INFO - VALID ACTIFS SITES 3107
[2024-07-25T11:58:36.796+0000] {motower_daily.py:130} INFO - GET CA PARC FILE OF THE DAY 2024-06-02
[2024-07-25T11:58:36.797+0000] {motower_daily.py:134} INFO - READING ca-parc/2024/06/02.csv
[2024-07-25T11:58:36.857+0000] {motower_daily.py:139} INFO - DAILY KPI -      day_id       ca_voix       ca_data      parc  parc_data   parc_2g  parc_3g  parc_4g  parc_5g  parc_other      ca_total
0  20240602  4.822626e+08  7.120804e+08  16714097    9177438  12057840   876499  5949531   319188     1385238  1.241494e+09
[2024-07-25T11:58:36.857+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_total
[2024-07-25T11:58:36.858+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_total ARE VALID
[2024-07-25T11:58:36.859+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_voix
[2024-07-25T11:58:36.859+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_voix ARE VALID
[2024-07-25T11:58:36.860+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_data
[2024-07-25T11:58:36.860+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_data ARE VALID
[2024-07-25T11:58:36.860+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc
[2024-07-25T11:58:36.861+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc ARE VALID
[2024-07-25T11:58:36.861+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_data
[2024-07-25T11:58:36.862+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_data ARE VALID
[2024-07-25T11:58:36.863+0000] {motower_daily.py:142} INFO - MERGING BDD AND CA
[2024-07-25T11:58:36.866+0000] {motower_daily.py:144} INFO - prepare final daily data
[2024-07-25T11:58:36.868+0000] {logging_mixin.py:188} INFO - Index(['site', 'site bts', 'site physique', 'code oci', 'gestionnaire',
       'proprietaire', 'autre code', 'code esco', 'code ihs', 'longitude',
       'latitude', 'type du site', 'statut', 'couche en service',
       'technologie sans tdd', 'technologie', 'date mes 2g', 'date mes',
       'date mes 3g', 'date mes 4g', 'annee construction pylone',
       'statut sharing', 'statut proprietaire', 'statut partage',
       'geo localite', 'commune', 'departement', 'region', 'district',
       'partenaires', 'localisation', 'equipementier telecom', 'ville',
       'quartier', 'type baie', 'hauteur batiment', 'tower type',
       'tower location', 'type geolocalite', 'tower height', 'type site ihs',
       'type energie', 'projet', 'id quartier', 'id geolocalite', 'clutter',
       'position site', 'type indoor', 'decoupage', 'sous coloc', 'tenant',
       'type de cable', 'mois', 'code oci id', 'day_id', 'id_site', 'ca_voix',
       'ca_data', 'ca_total', 'trafic_voix_in', 'trafic_data_in', 'parc',
       'parc_data', 'parc_2g', 'parc_3g', 'parc_4g', 'parc_5g', 'parc_other',
       'jour'],
      dtype='object')
[2024-07-25T11:58:36.870+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:151: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final.rename(columns=DAILY_CAPARC_COL, inplace=True)

[2024-07-25T11:58:36.895+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:152: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["trafic_data_in_mo"] = df_final["trafic_data_in"] / 1000

[2024-07-25T11:58:36.896+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:153: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["ca_norm"] = None

[2024-07-25T11:58:36.897+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:154: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["ca_mtd"] = None

[2024-07-25T11:58:36.897+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:155: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["segment"] = None

[2024-07-25T11:58:36.898+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:156: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["previous_segment"] = None

[2024-07-25T11:58:36.898+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:157: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["evolution_segment"] = None

[2024-07-25T11:58:36.898+0000] {logging_mixin.py:188} INFO - 6
[2024-07-25T11:58:36.899+0000] {logging_mixin.py:188} INFO - 2024-06-02 00:00:00
[2024-07-25T11:58:36.910+0000] {motower_daily.py:198} INFO - ADD  SEGMENT
[2024-07-25T11:58:37.222+0000] {motower_daily.py:203} INFO - DATA VALIDATION AFTER MERGING
[2024-07-25T11:58:37.222+0000] {data_validation.py:28} INFO - START VALIDATION 
[2024-07-25T11:58:37.224+0000] {data_validation.py:40} INFO - VALID ACTIFS SITES 3107
[2024-07-25T11:58:37.236+0000] {motower_daily.py:214} INFO - DAILY KPI -         jour       ca_voix      ca_data  parc_global  parc_data    parc_2g   parc_3g    parc_4g   parc_5g  autre_parc      ca_total
0 2024-06-02  4.705111e+08  699688383.6   14776871.0  8935471.0  3821885.0  122369.0  3167222.0  214239.0    447997.0  1.215856e+09
[2024-07-25T11:58:37.237+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_total
[2024-07-25T11:58:37.237+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_total ARE VALID
[2024-07-25T11:58:37.238+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_voix
[2024-07-25T11:58:37.238+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_voix ARE VALID
[2024-07-25T11:58:37.239+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_data
[2024-07-25T11:58:37.239+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_data ARE VALID
[2024-07-25T11:58:37.240+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_global
[2024-07-25T11:58:37.240+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_global ARE VALID
[2024-07-25T11:58:37.241+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_data
[2024-07-25T11:58:37.241+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_data ARE VALID
[2024-07-25T11:58:37.315+0000] {logging_mixin.py:188} INFO -         jour code_oci  ...  previous_segment evolution_segment
0 2024-06-02  OCI2831  ...              None              None
1 2024-06-02  OCI3257  ...              None              None
2 2024-06-02  OCI3428  ...              None              None
3 2024-06-02  OCI2587  ...              None              None
4 2024-06-02  OCI3260  ...              None              None

[5 rows x 38 columns]
[2024-07-25T11:58:37.390+0000] {logging_mixin.py:188} INFO -         jour code_oci  ...  previous_segment evolution_segment
0 2024-06-02  OCI2831  ...              None              None
1 2024-06-02  OCI3257  ...              None              None
2 2024-06-02  OCI3428  ...              None              None
3 2024-06-02  OCI2587  ...              None              None
4 2024-06-02  OCI3260  ...              None              None

[5 rows x 38 columns]
[2024-07-25T11:58:38.292+0000] {python.py:237} INFO - Done. Returned value was: None
[2024-07-25T11:58:38.293+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-07-25T11:58:38.308+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=motower_daily_prod, task_id=motower_dcaparc, run_id=scheduled__2024-06-03T06:00:00+00:00, execution_date=20240603T060000, start_date=20240725T115836, end_date=20240725T115838
[2024-07-25T11:58:38.682+0000] {local_task_job_runner.py:243} INFO - Task exited with return code 0
[2024-07-25T11:58:38.709+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-25T11:58:38.710+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-07-25T12:12:31.612+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-07-25T12:12:31.660+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [queued]>
[2024-07-25T12:12:31.679+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [queued]>
[2024-07-25T12:12:31.680+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-07-25T12:12:31.707+0000] {taskinstance.py:2330} INFO - Executing <Task(PythonOperator): motower_dcaparc> on 2024-06-03 06:00:00+00:00
[2024-07-25T12:12:31.730+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:62: DeprecationWarning: This process (pid=8052) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-07-25T12:12:31.732+0000] {standard_task_runner.py:64} INFO - Started process 8069 to run task
[2024-07-25T12:12:31.742+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'motower_daily_prod', 'motower_dcaparc', 'scheduled__2024-06-03T06:00:00+00:00', '--job-id', '1769', '--raw', '--subdir', 'DAGS_FOLDER/gps/custom_dags/motower_daily.py', '--cfg-path', '/tmp/tmp9drpqz6b']
[2024-07-25T12:12:31.744+0000] {standard_task_runner.py:91} INFO - Job 1769: Subtask motower_dcaparc
[2024-07-25T12:12:31.864+0000] {task_command.py:426} INFO - Running <TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [running]> on host b3845fb494d4
[2024-07-25T12:12:32.054+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_EMAIL='richmond.kongo@orange.com,assane.diop@orange.com,cyrille1.danho@orange.com,mohamed2.sylla@orange.com,amadou.diomande@orange.com,Jonas.kouame@orange.com,armand.kablan@orange.com,anicet.azombade@orange.com,etienne.kouadio@orange.com,bertine.kouakou@orange.com,florentine.kouakou@orange.com,ange.phaceli@orange.com,soulegame.soro@orange.com,innocent.yengo@orange.com' AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='motower_daily_prod' AIRFLOW_CTX_TASK_ID='motower_dcaparc' AIRFLOW_CTX_EXECUTION_DATE='2024-06-03T06:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-06-03T06:00:00+00:00'
[2024-07-25T12:12:32.056+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-07-25T12:12:32.073+0000] {motower_daily.py:109} INFO - get last modified bdd sites cleaned
[2024-07-25T12:12:32.087+0000] {motower_daily.py:120} INFO - READING BASE_SITES-cleaned/2024/06/02.csv
[2024-07-25T12:12:32.149+0000] {data_validation.py:28} INFO - START VALIDATION 
[2024-07-25T12:12:32.151+0000] {data_validation.py:40} INFO - VALID ACTIFS SITES 3107
[2024-07-25T12:12:32.152+0000] {motower_daily.py:130} INFO - GET CA PARC FILE OF THE DAY 2024-06-02
[2024-07-25T12:12:32.152+0000] {motower_daily.py:134} INFO - READING ca-parc/2024/06/02.csv
[2024-07-25T12:12:32.183+0000] {motower_daily.py:139} INFO - DAILY KPI -      day_id       ca_voix       ca_data      parc  parc_data   parc_2g  parc_3g  parc_4g  parc_5g  parc_other      ca_total
0  20240602  4.822626e+08  7.120804e+08  16714097    9177438  12057840   876499  5949531   319188     1385238  1.241494e+09
[2024-07-25T12:12:32.183+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_total
[2024-07-25T12:12:32.185+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_total ARE VALID
[2024-07-25T12:12:32.185+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_voix
[2024-07-25T12:12:32.186+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_voix ARE VALID
[2024-07-25T12:12:32.186+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_data
[2024-07-25T12:12:32.186+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_data ARE VALID
[2024-07-25T12:12:32.187+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc
[2024-07-25T12:12:32.188+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc ARE VALID
[2024-07-25T12:12:32.188+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_data
[2024-07-25T12:12:32.189+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_data ARE VALID
[2024-07-25T12:12:32.189+0000] {motower_daily.py:142} INFO - MERGING BDD AND CA
[2024-07-25T12:12:32.193+0000] {motower_daily.py:144} INFO - prepare final daily data
[2024-07-25T12:12:32.195+0000] {logging_mixin.py:188} INFO - Index(['site', 'site bts', 'site physique', 'code oci', 'gestionnaire',
       'proprietaire', 'autre code', 'code esco', 'code ihs', 'longitude',
       'latitude', 'type du site', 'statut', 'couche en service',
       'technologie sans tdd', 'technologie', 'date mes 2g', 'date mes',
       'date mes 3g', 'date mes 4g', 'annee construction pylone',
       'statut sharing', 'statut proprietaire', 'statut partage',
       'geo localite', 'commune', 'departement', 'region', 'district',
       'partenaires', 'localisation', 'equipementier telecom', 'ville',
       'quartier', 'type baie', 'hauteur batiment', 'tower type',
       'tower location', 'type geolocalite', 'tower height', 'type site ihs',
       'type energie', 'projet', 'id quartier', 'id geolocalite', 'clutter',
       'position site', 'type indoor', 'decoupage', 'sous coloc', 'tenant',
       'type de cable', 'mois', 'code oci id', 'day_id', 'id_site', 'ca_voix',
       'ca_data', 'ca_total', 'trafic_voix_in', 'trafic_data_in', 'parc',
       'parc_data', 'parc_2g', 'parc_3g', 'parc_4g', 'parc_5g', 'parc_other',
       'jour'],
      dtype='object')
[2024-07-25T12:12:32.198+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:151: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final.rename(columns=DAILY_CAPARC_COL, inplace=True)

[2024-07-25T12:12:32.199+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:152: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["trafic_data_in_mo"] = df_final["trafic_data_in"] / 1000

[2024-07-25T12:12:32.200+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:153: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["ca_norm"] = None

[2024-07-25T12:12:32.200+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:154: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["ca_mtd"] = None

[2024-07-25T12:12:32.201+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:155: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["segment"] = None

[2024-07-25T12:12:32.201+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:156: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["previous_segment"] = None

[2024-07-25T12:12:32.202+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:157: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["evolution_segment"] = None

[2024-07-25T12:12:32.202+0000] {logging_mixin.py:188} INFO - 6
[2024-07-25T12:12:32.202+0000] {logging_mixin.py:188} INFO - 2024-06-02 00:00:00
[2024-07-25T12:12:32.216+0000] {motower_daily.py:198} INFO - ADD  SEGMENT
[2024-07-25T12:12:32.427+0000] {motower_daily.py:203} INFO - DATA VALIDATION AFTER MERGING
[2024-07-25T12:12:32.427+0000] {data_validation.py:28} INFO - START VALIDATION 
[2024-07-25T12:12:32.428+0000] {data_validation.py:40} INFO - VALID ACTIFS SITES 3107
[2024-07-25T12:12:32.437+0000] {motower_daily.py:214} INFO - DAILY KPI -         jour       ca_voix      ca_data  parc_global  parc_data    parc_2g   parc_3g    parc_4g   parc_5g  autre_parc      ca_total
0 2024-06-02  4.705111e+08  699688383.6   14776871.0  8935471.0  3821885.0  122369.0  3167222.0  214239.0    447997.0  1.215856e+09
[2024-07-25T12:12:32.438+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_total
[2024-07-25T12:12:32.439+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_total ARE VALID
[2024-07-25T12:12:32.439+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_voix
[2024-07-25T12:12:32.440+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_voix ARE VALID
[2024-07-25T12:12:32.440+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_data
[2024-07-25T12:12:32.440+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_data ARE VALID
[2024-07-25T12:12:32.441+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_global
[2024-07-25T12:12:32.441+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_global ARE VALID
[2024-07-25T12:12:32.442+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_data
[2024-07-25T12:12:32.442+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_data ARE VALID
[2024-07-25T12:12:32.471+0000] {logging_mixin.py:188} INFO -         jour code_oci  ...  previous_segment evolution_segment
0 2024-06-02  OCI2831  ...              None              None
1 2024-06-02  OCI3257  ...              None              None
2 2024-06-02  OCI3428  ...              None              None
3 2024-06-02  OCI2587  ...              None              None
4 2024-06-02  OCI3260  ...              None              None

[5 rows x 38 columns]
[2024-07-25T12:12:32.504+0000] {logging_mixin.py:188} INFO -         jour code_oci  ...  previous_segment evolution_segment
0 2024-06-02  OCI2831  ...              None              None
1 2024-06-02  OCI3257  ...              None              None
2 2024-06-02  OCI3428  ...              None              None
3 2024-06-02  OCI2587  ...              None              None
4 2024-06-02  OCI3260  ...              None              None

[5 rows x 38 columns]
[2024-07-25T12:12:33.118+0000] {python.py:237} INFO - Done. Returned value was: None
[2024-07-25T12:12:33.119+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-07-25T12:12:33.129+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=motower_daily_prod, task_id=motower_dcaparc, run_id=scheduled__2024-06-03T06:00:00+00:00, execution_date=20240603T060000, start_date=20240725T121231, end_date=20240725T121233
[2024-07-25T12:12:33.455+0000] {local_task_job_runner.py:243} INFO - Task exited with return code 0
[2024-07-25T12:12:33.477+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-25T12:12:33.478+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-07-25T12:43:49.313+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-07-25T12:43:49.342+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [queued]>
[2024-07-25T12:43:49.353+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [queued]>
[2024-07-25T12:43:49.354+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-07-25T12:43:49.369+0000] {taskinstance.py:2330} INFO - Executing <Task(PythonOperator): motower_dcaparc> on 2024-06-03 06:00:00+00:00
[2024-07-25T12:43:49.384+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:62: DeprecationWarning: This process (pid=9438) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-07-25T12:43:49.386+0000] {standard_task_runner.py:64} INFO - Started process 9448 to run task
[2024-07-25T12:43:49.385+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'motower_daily_prod', 'motower_dcaparc', 'scheduled__2024-06-03T06:00:00+00:00', '--job-id', '2097', '--raw', '--subdir', 'DAGS_FOLDER/gps/custom_dags/motower_daily.py', '--cfg-path', '/tmp/tmp69jiduu0']
[2024-07-25T12:43:49.387+0000] {standard_task_runner.py:91} INFO - Job 2097: Subtask motower_dcaparc
[2024-07-25T12:43:49.431+0000] {task_command.py:426} INFO - Running <TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [running]> on host b3845fb494d4
[2024-07-25T12:43:49.539+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_EMAIL='richmond.kongo@orange.com,assane.diop@orange.com,cyrille1.danho@orange.com,mohamed2.sylla@orange.com,amadou.diomande@orange.com,Jonas.kouame@orange.com,armand.kablan@orange.com,anicet.azombade@orange.com,etienne.kouadio@orange.com,bertine.kouakou@orange.com,florentine.kouakou@orange.com,ange.phaceli@orange.com,soulegame.soro@orange.com,innocent.yengo@orange.com' AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='motower_daily_prod' AIRFLOW_CTX_TASK_ID='motower_dcaparc' AIRFLOW_CTX_EXECUTION_DATE='2024-06-03T06:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-06-03T06:00:00+00:00'
[2024-07-25T12:43:49.541+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-07-25T12:43:49.561+0000] {motower_daily.py:109} INFO - get last modified bdd sites cleaned
[2024-07-25T12:43:49.573+0000] {motower_daily.py:120} INFO - READING BASE_SITES-cleaned/2024/06/02.csv
[2024-07-25T12:43:49.652+0000] {data_validation.py:28} INFO - START VALIDATION 
[2024-07-25T12:43:49.655+0000] {data_validation.py:40} INFO - VALID ACTIFS SITES 3107
[2024-07-25T12:43:49.655+0000] {motower_daily.py:130} INFO - GET CA PARC FILE OF THE DAY 2024-06-02
[2024-07-25T12:43:49.656+0000] {motower_daily.py:134} INFO - READING ca-parc/2024/06/02.csv
[2024-07-25T12:43:49.690+0000] {motower_daily.py:139} INFO - DAILY KPI -      day_id       ca_voix       ca_data      parc  parc_data   parc_2g  parc_3g  parc_4g  parc_5g  parc_other      ca_total
0  20240602  4.822626e+08  7.120804e+08  16714097    9177438  12057840   876499  5949531   319188     1385238  1.241494e+09
[2024-07-25T12:43:49.690+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_total
[2024-07-25T12:43:49.692+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_total ARE VALID
[2024-07-25T12:43:49.692+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_voix
[2024-07-25T12:43:49.693+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_voix ARE VALID
[2024-07-25T12:43:49.693+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_data
[2024-07-25T12:43:49.694+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_data ARE VALID
[2024-07-25T12:43:49.694+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc
[2024-07-25T12:43:49.695+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc ARE VALID
[2024-07-25T12:43:49.696+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_data
[2024-07-25T12:43:49.696+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_data ARE VALID
[2024-07-25T12:43:49.697+0000] {motower_daily.py:142} INFO - MERGING BDD AND CA
[2024-07-25T12:43:49.701+0000] {motower_daily.py:144} INFO - prepare final daily data
[2024-07-25T12:43:49.703+0000] {logging_mixin.py:188} INFO - Index(['site', 'site bts', 'site physique', 'code oci', 'gestionnaire',
       'proprietaire', 'autre code', 'code esco', 'code ihs', 'longitude',
       'latitude', 'type du site', 'statut', 'couche en service',
       'technologie sans tdd', 'technologie', 'date mes 2g', 'date mes',
       'date mes 3g', 'date mes 4g', 'annee construction pylone',
       'statut sharing', 'statut proprietaire', 'statut partage',
       'geo localite', 'commune', 'departement', 'region', 'district',
       'partenaires', 'localisation', 'equipementier telecom', 'ville',
       'quartier', 'type baie', 'hauteur batiment', 'tower type',
       'tower location', 'type geolocalite', 'tower height', 'type site ihs',
       'type energie', 'projet', 'id quartier', 'id geolocalite', 'clutter',
       'position site', 'type indoor', 'decoupage', 'sous coloc', 'tenant',
       'type de cable', 'mois', 'code oci id', 'day_id', 'id_site', 'ca_voix',
       'ca_data', 'ca_total', 'trafic_voix_in', 'trafic_data_in', 'parc',
       'parc_data', 'parc_2g', 'parc_3g', 'parc_4g', 'parc_5g', 'parc_other',
       'jour'],
      dtype='object')
[2024-07-25T12:43:49.706+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:151: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final.rename(columns=DAILY_CAPARC_COL, inplace=True)

[2024-07-25T12:43:49.707+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:152: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["trafic_data_in_mo"] = df_final["trafic_data_in"] / 1000

[2024-07-25T12:43:49.708+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:153: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["ca_norm"] = None

[2024-07-25T12:43:49.708+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:154: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["ca_mtd"] = None

[2024-07-25T12:43:49.709+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:155: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["segment"] = None

[2024-07-25T12:43:49.710+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:156: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["previous_segment"] = None

[2024-07-25T12:43:49.710+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:157: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["evolution_segment"] = None

[2024-07-25T12:43:49.710+0000] {logging_mixin.py:188} INFO - 6
[2024-07-25T12:43:49.711+0000] {logging_mixin.py:188} INFO - 2024-06-02 00:00:00
[2024-07-25T12:43:49.724+0000] {motower_daily.py:198} INFO - ADD  SEGMENT
[2024-07-25T12:43:49.927+0000] {motower_daily.py:203} INFO - DATA VALIDATION AFTER MERGING
[2024-07-25T12:43:49.927+0000] {data_validation.py:28} INFO - START VALIDATION 
[2024-07-25T12:43:49.928+0000] {data_validation.py:40} INFO - VALID ACTIFS SITES 3107
[2024-07-25T12:43:49.937+0000] {motower_daily.py:214} INFO - DAILY KPI -         jour       ca_voix      ca_data  parc_global  parc_data    parc_2g   parc_3g    parc_4g   parc_5g  autre_parc      ca_total
0 2024-06-02  4.705111e+08  699688383.6   14776871.0  8935471.0  3821885.0  122369.0  3167222.0  214239.0    447997.0  1.215856e+09
[2024-07-25T12:43:49.937+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_total
[2024-07-25T12:43:49.938+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_total ARE VALID
[2024-07-25T12:43:49.939+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_voix
[2024-07-25T12:43:49.939+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_voix ARE VALID
[2024-07-25T12:43:49.940+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_data
[2024-07-25T12:43:49.940+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_data ARE VALID
[2024-07-25T12:43:49.941+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_global
[2024-07-25T12:43:49.941+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_global ARE VALID
[2024-07-25T12:43:49.942+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_data
[2024-07-25T12:43:49.942+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_data ARE VALID
[2024-07-25T12:43:49.977+0000] {logging_mixin.py:188} INFO -         jour code_oci  ...  previous_segment evolution_segment
0 2024-06-02  OCI2831  ...              None              None
1 2024-06-02  OCI3257  ...              None              None
2 2024-06-02  OCI3428  ...              None              None
3 2024-06-02  OCI2587  ...              None              None
4 2024-06-02  OCI3260  ...              None              None

[5 rows x 38 columns]
[2024-07-25T12:43:50.013+0000] {logging_mixin.py:188} INFO -         jour code_oci  ...  previous_segment evolution_segment
0 2024-06-02  OCI2831  ...              None              None
1 2024-06-02  OCI3257  ...              None              None
2 2024-06-02  OCI3428  ...              None              None
3 2024-06-02  OCI2587  ...              None              None
4 2024-06-02  OCI3260  ...              None              None

[5 rows x 38 columns]
[2024-07-25T12:43:50.844+0000] {python.py:237} INFO - Done. Returned value was: None
[2024-07-25T12:43:50.845+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-07-25T12:43:50.859+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=motower_daily_prod, task_id=motower_dcaparc, run_id=scheduled__2024-06-03T06:00:00+00:00, execution_date=20240603T060000, start_date=20240725T124349, end_date=20240725T124350
[2024-07-25T12:43:50.971+0000] {local_task_job_runner.py:243} INFO - Task exited with return code 0
[2024-07-25T12:43:51.002+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-25T12:43:51.011+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-07-25T15:06:12.291+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-07-25T15:06:12.314+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [queued]>
[2024-07-25T15:06:12.321+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [queued]>
[2024-07-25T15:06:12.321+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-07-25T15:06:12.331+0000] {taskinstance.py:2330} INFO - Executing <Task(PythonOperator): motower_dcaparc> on 2024-06-03 06:00:00+00:00
[2024-07-25T15:06:12.339+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:62: DeprecationWarning: This process (pid=14082) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-07-25T15:06:12.341+0000] {standard_task_runner.py:64} INFO - Started process 14092 to run task
[2024-07-25T15:06:12.341+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'motower_daily_prod', 'motower_dcaparc', 'scheduled__2024-06-03T06:00:00+00:00', '--job-id', '3034', '--raw', '--subdir', 'DAGS_FOLDER/gps/custom_dags/motower_daily.py', '--cfg-path', '/tmp/tmpub9w8w8q']
[2024-07-25T15:06:12.342+0000] {standard_task_runner.py:91} INFO - Job 3034: Subtask motower_dcaparc
[2024-07-25T15:06:12.378+0000] {task_command.py:426} INFO - Running <TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [running]> on host b3845fb494d4
[2024-07-25T15:06:12.455+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_EMAIL='richmond.kongo@orange.com,assane.diop@orange.com,cyrille1.danho@orange.com,mohamed2.sylla@orange.com,amadou.diomande@orange.com,Jonas.kouame@orange.com,armand.kablan@orange.com,anicet.azombade@orange.com,etienne.kouadio@orange.com,bertine.kouakou@orange.com,florentine.kouakou@orange.com,ange.phaceli@orange.com,soulegame.soro@orange.com,innocent.yengo@orange.com' AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='motower_daily_prod' AIRFLOW_CTX_TASK_ID='motower_dcaparc' AIRFLOW_CTX_EXECUTION_DATE='2024-06-03T06:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-06-03T06:00:00+00:00'
[2024-07-25T15:06:12.456+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-07-25T15:06:12.470+0000] {motower_daily.py:106} INFO - get last modified bdd sites cleaned
[2024-07-25T15:06:12.478+0000] {motower_daily.py:117} INFO - READING BASE_SITES-cleaned/2024/06/02.csv
[2024-07-25T15:06:12.515+0000] {data_validation.py:28} INFO - START VALIDATION 
[2024-07-25T15:06:12.517+0000] {data_validation.py:40} INFO - VALID ACTIFS SITES 3107
[2024-07-25T15:06:12.517+0000] {motower_daily.py:127} INFO - GET CA PARC FILE OF THE DAY 2024-06-02
[2024-07-25T15:06:12.517+0000] {motower_daily.py:131} INFO - READING ca-parc/2024/06/02.csv
[2024-07-25T15:06:12.536+0000] {motower_daily.py:136} INFO - DAILY KPI -      day_id       ca_voix       ca_data      parc  parc_data   parc_2g  parc_3g  parc_4g  parc_5g  parc_other      ca_total
0  20240602  4.822626e+08  7.120804e+08  16714097    9177438  12057840   876499  5949531   319188     1385238  1.241494e+09
[2024-07-25T15:06:12.536+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_total
[2024-07-25T15:06:12.537+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_total ARE VALID
[2024-07-25T15:06:12.537+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_voix
[2024-07-25T15:06:12.538+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_voix ARE VALID
[2024-07-25T15:06:12.538+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_data
[2024-07-25T15:06:12.539+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_data ARE VALID
[2024-07-25T15:06:12.539+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc
[2024-07-25T15:06:12.539+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc ARE VALID
[2024-07-25T15:06:12.539+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_data
[2024-07-25T15:06:12.540+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_data ARE VALID
[2024-07-25T15:06:12.540+0000] {motower_daily.py:139} INFO - MERGING BDD AND CA
[2024-07-25T15:06:12.543+0000] {motower_daily.py:141} INFO - prepare final daily data
[2024-07-25T15:06:12.544+0000] {logging_mixin.py:188} INFO - Index(['site', 'site bts', 'site physique', 'code oci', 'gestionnaire',
       'proprietaire', 'autre code', 'code esco', 'code ihs', 'longitude',
       'latitude', 'type du site', 'statut', 'couche en service',
       'technologie sans tdd', 'technologie', 'date mes 2g', 'date mes',
       'date mes 3g', 'date mes 4g', 'annee construction pylone',
       'statut sharing', 'statut proprietaire', 'statut partage',
       'geo localite', 'commune', 'departement', 'region', 'district',
       'partenaires', 'localisation', 'equipementier telecom', 'ville',
       'quartier', 'type baie', 'hauteur batiment', 'tower type',
       'tower location', 'type geolocalite', 'tower height', 'type site ihs',
       'type energie', 'projet', 'id quartier', 'id geolocalite', 'clutter',
       'position site', 'type indoor', 'decoupage', 'sous coloc', 'tenant',
       'type de cable', 'mois', 'code oci id', 'day_id', 'id_site', 'ca_voix',
       'ca_data', 'ca_total', 'trafic_voix_in', 'trafic_data_in', 'parc',
       'parc_data', 'parc_2g', 'parc_3g', 'parc_4g', 'parc_5g', 'parc_other',
       'jour'],
      dtype='object')
[2024-07-25T15:06:12.545+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:148: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final.rename(columns=DAILY_CAPARC_COL, inplace=True)

[2024-07-25T15:06:12.546+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:149: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["trafic_data_in_mo"] = df_final["trafic_data_in"] / 1000

[2024-07-25T15:06:12.546+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:150: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["ca_norm"] = None

[2024-07-25T15:06:12.546+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:151: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["ca_mtd"] = None

[2024-07-25T15:06:12.547+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:152: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["segment"] = None

[2024-07-25T15:06:12.547+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:153: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["previous_segment"] = None

[2024-07-25T15:06:12.547+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:154: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["evolution_segment"] = None

[2024-07-25T15:06:12.548+0000] {logging_mixin.py:188} INFO - 6
[2024-07-25T15:06:12.548+0000] {logging_mixin.py:188} INFO - 2024-06-02 00:00:00
[2024-07-25T15:06:12.555+0000] {motower_daily.py:200} INFO - ADD  SEGMENT
[2024-07-25T15:06:12.692+0000] {motower_daily.py:205} INFO - DATA VALIDATION AFTER MERGING
[2024-07-25T15:06:12.692+0000] {data_validation.py:28} INFO - START VALIDATION 
[2024-07-25T15:06:12.693+0000] {data_validation.py:40} INFO - VALID ACTIFS SITES 3107
[2024-07-25T15:06:12.700+0000] {motower_daily.py:216} INFO - DAILY KPI -         jour       ca_voix      ca_data  parc_global  parc_data    parc_2g   parc_3g    parc_4g   parc_5g  autre_parc      ca_total
0 2024-06-02  4.705111e+08  699688383.6   14776871.0  8935471.0  3821885.0  122369.0  3167222.0  214239.0    447997.0  1.215856e+09
[2024-07-25T15:06:12.700+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_total
[2024-07-25T15:06:12.700+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_total ARE VALID
[2024-07-25T15:06:12.701+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_voix
[2024-07-25T15:06:12.701+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_voix ARE VALID
[2024-07-25T15:06:12.701+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_data
[2024-07-25T15:06:12.702+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_data ARE VALID
[2024-07-25T15:06:12.702+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_global
[2024-07-25T15:06:12.703+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_global ARE VALID
[2024-07-25T15:06:12.703+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_data
[2024-07-25T15:06:12.703+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_data ARE VALID
[2024-07-25T15:06:12.726+0000] {logging_mixin.py:188} INFO -         jour code_oci  ...  previous_segment evolution_segment
0 2024-06-02  OCI2831  ...              None              None
1 2024-06-02  OCI3257  ...              None              None
2 2024-06-02  OCI3428  ...              None              None
3 2024-06-02  OCI2587  ...              None              None
4 2024-06-02  OCI3260  ...              None              None

[5 rows x 38 columns]
[2024-07-25T15:06:12.749+0000] {logging_mixin.py:188} INFO -         jour code_oci  ...  previous_segment evolution_segment
0 2024-06-02  OCI2831  ...              None              None
1 2024-06-02  OCI3257  ...              None              None
2 2024-06-02  OCI3428  ...              None              None
3 2024-06-02  OCI2587  ...              None              None
4 2024-06-02  OCI3260  ...              None              None

[5 rows x 38 columns]
[2024-07-25T15:06:13.336+0000] {python.py:237} INFO - Done. Returned value was: None
[2024-07-25T15:06:13.338+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-07-25T15:06:13.350+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=motower_daily_prod, task_id=motower_dcaparc, run_id=scheduled__2024-06-03T06:00:00+00:00, execution_date=20240603T060000, start_date=20240725T150612, end_date=20240725T150613
[2024-07-25T15:06:13.639+0000] {local_task_job_runner.py:243} INFO - Task exited with return code 0
[2024-07-25T15:06:13.663+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-25T15:06:13.664+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-07-26T11:42:20.530+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-07-26T11:42:20.567+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [queued]>
[2024-07-26T11:42:20.581+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [queued]>
[2024-07-26T11:42:20.582+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-07-26T11:42:20.904+0000] {taskinstance.py:2330} INFO - Executing <Task(PythonOperator): motower_dcaparc> on 2024-06-03 06:00:00+00:00
[2024-07-26T11:42:20.919+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:62: DeprecationWarning: This process (pid=2172) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-07-26T11:42:20.921+0000] {standard_task_runner.py:64} INFO - Started process 2192 to run task
[2024-07-26T11:42:20.921+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'motower_daily_prod', 'motower_dcaparc', 'scheduled__2024-06-03T06:00:00+00:00', '--job-id', '3683', '--raw', '--subdir', 'DAGS_FOLDER/gps/custom_dags/motower_daily.py', '--cfg-path', '/tmp/tmptdzwsm1o']
[2024-07-26T11:42:20.924+0000] {standard_task_runner.py:91} INFO - Job 3683: Subtask motower_dcaparc
[2024-07-26T11:42:21.002+0000] {task_command.py:426} INFO - Running <TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [running]> on host b3845fb494d4
[2024-07-26T11:42:21.160+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_EMAIL='richmond.kongo@orange.com,assane.diop@orange.com,cyrille1.danho@orange.com,mohamed2.sylla@orange.com,amadou.diomande@orange.com,Jonas.kouame@orange.com,armand.kablan@orange.com,anicet.azombade@orange.com,etienne.kouadio@orange.com,bertine.kouakou@orange.com,florentine.kouakou@orange.com,ange.phaceli@orange.com,soulegame.soro@orange.com,innocent.yengo@orange.com' AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='motower_daily_prod' AIRFLOW_CTX_TASK_ID='motower_dcaparc' AIRFLOW_CTX_EXECUTION_DATE='2024-06-03T06:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-06-03T06:00:00+00:00'
[2024-07-26T11:42:21.161+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-07-26T11:42:21.193+0000] {motower_daily.py:106} INFO - get last modified bdd sites cleaned
[2024-07-26T11:42:21.207+0000] {motower_daily.py:117} INFO - READING BASE_SITES-cleaned/2024/06/02.csv
[2024-07-26T11:42:21.277+0000] {data_validation.py:28} INFO - START VALIDATION 
[2024-07-26T11:42:21.280+0000] {data_validation.py:40} INFO - VALID ACTIFS SITES 3107
[2024-07-26T11:42:21.281+0000] {motower_daily.py:127} INFO - GET CA PARC FILE OF THE DAY 2024-06-02
[2024-07-26T11:42:21.282+0000] {motower_daily.py:131} INFO - READING ca-parc/2024/06/02.csv
[2024-07-26T11:42:21.316+0000] {motower_daily.py:136} INFO - DAILY KPI -      day_id       ca_voix       ca_data      parc  parc_data   parc_2g  parc_3g  parc_4g  parc_5g  parc_other      ca_total
0  20240602  4.822626e+08  7.120804e+08  16714097    9177438  12057840   876499  5949531   319188     1385238  1.241494e+09
[2024-07-26T11:42:21.316+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_total
[2024-07-26T11:42:21.318+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_total ARE VALID
[2024-07-26T11:42:21.319+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_voix
[2024-07-26T11:42:21.320+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_voix ARE VALID
[2024-07-26T11:42:21.320+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_data
[2024-07-26T11:42:21.321+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_data ARE VALID
[2024-07-26T11:42:21.322+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc
[2024-07-26T11:42:21.323+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc ARE VALID
[2024-07-26T11:42:21.323+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_data
[2024-07-26T11:42:21.324+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_data ARE VALID
[2024-07-26T11:42:21.325+0000] {motower_daily.py:139} INFO - MERGING BDD AND CA
[2024-07-26T11:42:21.330+0000] {motower_daily.py:141} INFO - prepare final daily data
[2024-07-26T11:42:21.332+0000] {logging_mixin.py:188} INFO - Index(['site', 'site bts', 'site physique', 'code oci', 'gestionnaire',
       'proprietaire', 'autre code', 'code esco', 'code ihs', 'longitude',
       'latitude', 'type du site', 'statut', 'couche en service',
       'technologie sans tdd', 'technologie', 'date mes 2g', 'date mes',
       'date mes 3g', 'date mes 4g', 'annee construction pylone',
       'statut sharing', 'statut proprietaire', 'statut partage',
       'geo localite', 'commune', 'departement', 'region', 'district',
       'partenaires', 'localisation', 'equipementier telecom', 'ville',
       'quartier', 'type baie', 'hauteur batiment', 'tower type',
       'tower location', 'type geolocalite', 'tower height', 'type site ihs',
       'type energie', 'projet', 'id quartier', 'id geolocalite', 'clutter',
       'position site', 'type indoor', 'decoupage', 'sous coloc', 'tenant',
       'type de cable', 'mois', 'code oci id', 'day_id', 'id_site', 'ca_voix',
       'ca_data', 'ca_total', 'trafic_voix_in', 'trafic_data_in', 'parc',
       'parc_data', 'parc_2g', 'parc_3g', 'parc_4g', 'parc_5g', 'parc_other',
       'jour'],
      dtype='object')
[2024-07-26T11:42:21.335+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:148: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final.rename(columns=DAILY_CAPARC_COL, inplace=True)

[2024-07-26T11:42:21.337+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:149: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["trafic_data_in_mo"] = df_final["trafic_data_in"] / 1000

[2024-07-26T11:42:21.338+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:150: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["ca_norm"] = None

[2024-07-26T11:42:21.339+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:151: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["ca_mtd"] = None

[2024-07-26T11:42:21.340+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:152: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["segment"] = None

[2024-07-26T11:42:21.340+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:153: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["previous_segment"] = None

[2024-07-26T11:42:21.341+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:154: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["evolution_segment"] = None

[2024-07-26T11:42:21.341+0000] {logging_mixin.py:188} INFO - 6
[2024-07-26T11:42:21.342+0000] {logging_mixin.py:188} INFO - 2024-06-02 00:00:00
[2024-07-26T11:42:21.359+0000] {motower_daily.py:200} INFO - ADD  SEGMENT
[2024-07-26T11:42:21.676+0000] {motower_daily.py:205} INFO - DATA VALIDATION AFTER MERGING
[2024-07-26T11:42:21.677+0000] {data_validation.py:28} INFO - START VALIDATION 
[2024-07-26T11:42:21.680+0000] {data_validation.py:40} INFO - VALID ACTIFS SITES 3107
[2024-07-26T11:42:21.695+0000] {motower_daily.py:216} INFO - DAILY KPI -         jour       ca_voix      ca_data  parc_global  parc_data    parc_2g   parc_3g    parc_4g   parc_5g  autre_parc      ca_total
0 2024-06-02  4.705111e+08  699688383.6   14776871.0  8935471.0  3821885.0  122369.0  3167222.0  214239.0    447997.0  1.215856e+09
[2024-07-26T11:42:21.696+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_total
[2024-07-26T11:42:21.698+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_total ARE VALID
[2024-07-26T11:42:21.700+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_voix
[2024-07-26T11:42:21.702+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_voix ARE VALID
[2024-07-26T11:42:21.703+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_data
[2024-07-26T11:42:21.705+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_data ARE VALID
[2024-07-26T11:42:21.706+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_global
[2024-07-26T11:42:21.708+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_global ARE VALID
[2024-07-26T11:42:21.709+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_data
[2024-07-26T11:42:21.711+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_data ARE VALID
[2024-07-26T11:42:21.759+0000] {logging_mixin.py:188} INFO -         jour code_oci  ...  previous_segment evolution_segment
0 2024-06-02  OCI2831  ...              None              None
1 2024-06-02  OCI3257  ...              None              None
2 2024-06-02  OCI3428  ...              None              None
3 2024-06-02  OCI2587  ...              None              None
4 2024-06-02  OCI3260  ...              None              None

[5 rows x 38 columns]
[2024-07-26T11:42:21.808+0000] {logging_mixin.py:188} INFO -         jour code_oci  ...  previous_segment evolution_segment
0 2024-06-02  OCI2831  ...              None              None
1 2024-06-02  OCI3257  ...              None              None
2 2024-06-02  OCI3428  ...              None              None
3 2024-06-02  OCI2587  ...              None              None
4 2024-06-02  OCI3260  ...              None              None

[5 rows x 38 columns]
[2024-07-26T11:42:22.780+0000] {python.py:237} INFO - Done. Returned value was: None
[2024-07-26T11:42:22.781+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-07-26T11:42:22.792+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=motower_daily_prod, task_id=motower_dcaparc, run_id=scheduled__2024-06-03T06:00:00+00:00, execution_date=20240603T060000, start_date=20240726T114220, end_date=20240726T114222
[2024-07-26T11:42:23.054+0000] {local_task_job_runner.py:243} INFO - Task exited with return code 0
[2024-07-26T11:42:23.075+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-26T11:42:23.077+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-07-26T12:20:09.963+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-07-26T12:20:10.053+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [queued]>
[2024-07-26T12:20:10.102+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [queued]>
[2024-07-26T12:20:10.102+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-07-26T12:20:10.154+0000] {taskinstance.py:2330} INFO - Executing <Task(PythonOperator): motower_dcaparc> on 2024-06-03 06:00:00+00:00
[2024-07-26T12:20:10.186+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:62: DeprecationWarning: This process (pid=527) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-07-26T12:20:10.188+0000] {standard_task_runner.py:64} INFO - Started process 550 to run task
[2024-07-26T12:20:10.190+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'motower_daily_prod', 'motower_dcaparc', 'scheduled__2024-06-03T06:00:00+00:00', '--job-id', '146', '--raw', '--subdir', 'DAGS_FOLDER/gps/custom_dags/motower_daily.py', '--cfg-path', '/tmp/tmpaczir1x1']
[2024-07-26T12:20:10.192+0000] {standard_task_runner.py:91} INFO - Job 146: Subtask motower_dcaparc
[2024-07-26T12:20:10.284+0000] {task_command.py:426} INFO - Running <TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [running]> on host 88c2b04746a4
[2024-07-26T12:20:10.449+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_EMAIL='richmond.kongo@orange.com,assane.diop@orange.com,cyrille1.danho@orange.com,mohamed2.sylla@orange.com,amadou.diomande@orange.com,Jonas.kouame@orange.com,armand.kablan@orange.com,anicet.azombade@orange.com,etienne.kouadio@orange.com,bertine.kouakou@orange.com,florentine.kouakou@orange.com,ange.phaceli@orange.com,soulegame.soro@orange.com,innocent.yengo@orange.com' AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='motower_daily_prod' AIRFLOW_CTX_TASK_ID='motower_dcaparc' AIRFLOW_CTX_EXECUTION_DATE='2024-06-03T06:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-06-03T06:00:00+00:00'
[2024-07-26T12:20:10.451+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-07-26T12:20:10.491+0000] {motower_daily.py:106} INFO - get last modified bdd sites cleaned
[2024-07-26T12:20:10.508+0000] {motower_daily.py:117} INFO - READING BASE_SITES-cleaned/2024/06/02.csv
[2024-07-26T12:20:10.588+0000] {data_validation.py:28} INFO - START VALIDATION 
[2024-07-26T12:20:10.590+0000] {data_validation.py:40} INFO - VALID ACTIFS SITES 3107
[2024-07-26T12:20:10.591+0000] {motower_daily.py:127} INFO - GET CA PARC FILE OF THE DAY 2024-06-02
[2024-07-26T12:20:10.591+0000] {motower_daily.py:131} INFO - READING ca-parc/2024/06/02.csv
[2024-07-26T12:20:10.617+0000] {motower_daily.py:136} INFO - DAILY KPI -      day_id       ca_voix       ca_data      parc  parc_data   parc_2g  parc_3g  parc_4g  parc_5g  parc_other      ca_total
0  20240602  4.822626e+08  7.120804e+08  16714097    9177438  12057840   876499  5949531   319188     1385238  1.241494e+09
[2024-07-26T12:20:10.618+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_total
[2024-07-26T12:20:10.619+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_total ARE VALID
[2024-07-26T12:20:10.620+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_voix
[2024-07-26T12:20:10.621+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_voix ARE VALID
[2024-07-26T12:20:10.621+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_data
[2024-07-26T12:20:10.622+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_data ARE VALID
[2024-07-26T12:20:10.622+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc
[2024-07-26T12:20:10.623+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc ARE VALID
[2024-07-26T12:20:10.623+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_data
[2024-07-26T12:20:10.624+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_data ARE VALID
[2024-07-26T12:20:10.624+0000] {motower_daily.py:139} INFO - MERGING BDD AND CA
[2024-07-26T12:20:10.629+0000] {motower_daily.py:141} INFO - prepare final daily data
[2024-07-26T12:20:10.630+0000] {logging_mixin.py:188} INFO - Index(['site', 'site bts', 'site physique', 'code oci', 'gestionnaire',
       'proprietaire', 'autre code', 'code esco', 'code ihs', 'longitude',
       'latitude', 'type du site', 'statut', 'couche en service',
       'technologie sans tdd', 'technologie', 'date mes 2g', 'date mes',
       'date mes 3g', 'date mes 4g', 'annee construction pylone',
       'statut sharing', 'statut proprietaire', 'statut partage',
       'geo localite', 'commune', 'departement', 'region', 'district',
       'partenaires', 'localisation', 'equipementier telecom', 'ville',
       'quartier', 'type baie', 'hauteur batiment', 'tower type',
       'tower location', 'type geolocalite', 'tower height', 'type site ihs',
       'type energie', 'projet', 'id quartier', 'id geolocalite', 'clutter',
       'position site', 'type indoor', 'decoupage', 'sous coloc', 'tenant',
       'type de cable', 'mois', 'code oci id', 'day_id', 'id_site', 'ca_voix',
       'ca_data', 'ca_total', 'trafic_voix_in', 'trafic_data_in', 'parc',
       'parc_data', 'parc_2g', 'parc_3g', 'parc_4g', 'parc_5g', 'parc_other',
       'jour'],
      dtype='object')
[2024-07-26T12:20:10.633+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:148: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final.rename(columns=DAILY_CAPARC_COL, inplace=True)

[2024-07-26T12:20:10.634+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:149: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["trafic_data_in_mo"] = df_final["trafic_data_in"] / 1000

[2024-07-26T12:20:10.635+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:150: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["ca_norm"] = None

[2024-07-26T12:20:10.636+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:151: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["ca_mtd"] = None

[2024-07-26T12:20:10.637+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:152: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["segment"] = None

[2024-07-26T12:20:10.637+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:153: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["previous_segment"] = None

[2024-07-26T12:20:10.638+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:154: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["evolution_segment"] = None

[2024-07-26T12:20:10.638+0000] {logging_mixin.py:188} INFO - 6
[2024-07-26T12:20:10.639+0000] {logging_mixin.py:188} INFO - 2024-06-02 00:00:00
[2024-07-26T12:20:10.649+0000] {motower_daily.py:200} INFO - ADD  SEGMENT
[2024-07-26T12:20:10.854+0000] {motower_daily.py:205} INFO - DATA VALIDATION AFTER MERGING
[2024-07-26T12:20:10.855+0000] {data_validation.py:28} INFO - START VALIDATION 
[2024-07-26T12:20:10.856+0000] {data_validation.py:40} INFO - VALID ACTIFS SITES 3107
[2024-07-26T12:20:10.866+0000] {motower_daily.py:216} INFO - DAILY KPI -         jour       ca_voix      ca_data  parc_global  parc_data    parc_2g   parc_3g    parc_4g   parc_5g  autre_parc      ca_total
0 2024-06-02  4.705111e+08  699688383.6   14776871.0  8935471.0  3821885.0  122369.0  3167222.0  214239.0    447997.0  1.215856e+09
[2024-07-26T12:20:10.866+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_total
[2024-07-26T12:20:10.867+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_total ARE VALID
[2024-07-26T12:20:10.868+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_voix
[2024-07-26T12:20:10.868+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_voix ARE VALID
[2024-07-26T12:20:10.869+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_data
[2024-07-26T12:20:10.869+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_data ARE VALID
[2024-07-26T12:20:10.870+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_global
[2024-07-26T12:20:10.870+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_global ARE VALID
[2024-07-26T12:20:10.871+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_data
[2024-07-26T12:20:10.872+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_data ARE VALID
[2024-07-26T12:20:10.904+0000] {logging_mixin.py:188} INFO -         jour code_oci  ...  previous_segment evolution_segment
0 2024-06-02  OCI2831  ...              None              None
1 2024-06-02  OCI3257  ...              None              None
2 2024-06-02  OCI3428  ...              None              None
3 2024-06-02  OCI2587  ...              None              None
4 2024-06-02  OCI3260  ...              None              None

[5 rows x 38 columns]
[2024-07-26T12:20:10.935+0000] {logging_mixin.py:188} INFO -         jour code_oci  ...  previous_segment evolution_segment
0 2024-06-02  OCI2831  ...              None              None
1 2024-06-02  OCI3257  ...              None              None
2 2024-06-02  OCI3428  ...              None              None
3 2024-06-02  OCI2587  ...              None              None
4 2024-06-02  OCI3260  ...              None              None

[5 rows x 38 columns]
[2024-07-26T12:20:10.943+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/custom_dags/motower_daily.py:133: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_faits['mois'] = data["jour"].dt.month

[2024-07-26T12:20:10.944+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/custom_dags/motower_daily.py:134: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_faits['annee'] = data["jour"].dt.month

[2024-07-26T12:20:14.678+0000] {python.py:237} INFO - Done. Returned value was: None
[2024-07-26T12:20:14.679+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-07-26T12:20:14.704+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=motower_daily_prod, task_id=motower_dcaparc, run_id=scheduled__2024-06-03T06:00:00+00:00, execution_date=20240603T060000, start_date=20240726T122010, end_date=20240726T122014
[2024-07-26T12:20:15.093+0000] {local_task_job_runner.py:243} INFO - Task exited with return code 0
[2024-07-26T12:20:15.119+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-26T12:20:15.123+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-07-26T12:23:21.128+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-07-26T12:23:21.160+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [queued]>
[2024-07-26T12:23:21.171+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [queued]>
[2024-07-26T12:23:21.172+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-07-26T12:23:21.186+0000] {taskinstance.py:2330} INFO - Executing <Task(PythonOperator): motower_dcaparc> on 2024-06-03 06:00:00+00:00
[2024-07-26T12:23:21.201+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:62: DeprecationWarning: This process (pid=1361) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-07-26T12:23:21.203+0000] {standard_task_runner.py:64} INFO - Started process 1372 to run task
[2024-07-26T12:23:21.203+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'motower_daily_prod', 'motower_dcaparc', 'scheduled__2024-06-03T06:00:00+00:00', '--job-id', '404', '--raw', '--subdir', 'DAGS_FOLDER/gps/custom_dags/motower_daily.py', '--cfg-path', '/tmp/tmp0a7d5ku0']
[2024-07-26T12:23:21.205+0000] {standard_task_runner.py:91} INFO - Job 404: Subtask motower_dcaparc
[2024-07-26T12:23:21.259+0000] {task_command.py:426} INFO - Running <TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [running]> on host 88c2b04746a4
[2024-07-26T12:23:21.384+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_EMAIL='richmond.kongo@orange.com,assane.diop@orange.com,cyrille1.danho@orange.com,mohamed2.sylla@orange.com,amadou.diomande@orange.com,Jonas.kouame@orange.com,armand.kablan@orange.com,anicet.azombade@orange.com,etienne.kouadio@orange.com,bertine.kouakou@orange.com,florentine.kouakou@orange.com,ange.phaceli@orange.com,soulegame.soro@orange.com,innocent.yengo@orange.com' AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='motower_daily_prod' AIRFLOW_CTX_TASK_ID='motower_dcaparc' AIRFLOW_CTX_EXECUTION_DATE='2024-06-03T06:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-06-03T06:00:00+00:00'
[2024-07-26T12:23:21.385+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-07-26T12:23:21.407+0000] {motower_daily.py:106} INFO - get last modified bdd sites cleaned
[2024-07-26T12:23:21.423+0000] {motower_daily.py:117} INFO - READING BASE_SITES-cleaned/2024/06/02.csv
[2024-07-26T12:23:21.500+0000] {data_validation.py:28} INFO - START VALIDATION 
[2024-07-26T12:23:21.502+0000] {data_validation.py:40} INFO - VALID ACTIFS SITES 3107
[2024-07-26T12:23:21.503+0000] {motower_daily.py:127} INFO - GET CA PARC FILE OF THE DAY 2024-06-02
[2024-07-26T12:23:21.503+0000] {motower_daily.py:131} INFO - READING ca-parc/2024/06/02.csv
[2024-07-26T12:23:21.533+0000] {motower_daily.py:136} INFO - DAILY KPI -      day_id       ca_voix       ca_data      parc  parc_data   parc_2g  parc_3g  parc_4g  parc_5g  parc_other      ca_total
0  20240602  4.822626e+08  7.120804e+08  16714097    9177438  12057840   876499  5949531   319188     1385238  1.241494e+09
[2024-07-26T12:23:21.534+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_total
[2024-07-26T12:23:21.536+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_total ARE VALID
[2024-07-26T12:23:21.536+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_voix
[2024-07-26T12:23:21.537+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_voix ARE VALID
[2024-07-26T12:23:21.537+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_data
[2024-07-26T12:23:21.538+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_data ARE VALID
[2024-07-26T12:23:21.538+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc
[2024-07-26T12:23:21.539+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc ARE VALID
[2024-07-26T12:23:21.539+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_data
[2024-07-26T12:23:21.540+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_data ARE VALID
[2024-07-26T12:23:21.540+0000] {motower_daily.py:139} INFO - MERGING BDD AND CA
[2024-07-26T12:23:21.546+0000] {motower_daily.py:141} INFO - prepare final daily data
[2024-07-26T12:23:21.548+0000] {logging_mixin.py:188} INFO - Index(['site', 'site bts', 'site physique', 'code oci', 'gestionnaire',
       'proprietaire', 'autre code', 'code esco', 'code ihs', 'longitude',
       'latitude', 'type du site', 'statut', 'couche en service',
       'technologie sans tdd', 'technologie', 'date mes 2g', 'date mes',
       'date mes 3g', 'date mes 4g', 'annee construction pylone',
       'statut sharing', 'statut proprietaire', 'statut partage',
       'geo localite', 'commune', 'departement', 'region', 'district',
       'partenaires', 'localisation', 'equipementier telecom', 'ville',
       'quartier', 'type baie', 'hauteur batiment', 'tower type',
       'tower location', 'type geolocalite', 'tower height', 'type site ihs',
       'type energie', 'projet', 'id quartier', 'id geolocalite', 'clutter',
       'position site', 'type indoor', 'decoupage', 'sous coloc', 'tenant',
       'type de cable', 'mois', 'code oci id', 'day_id', 'id_site', 'ca_voix',
       'ca_data', 'ca_total', 'trafic_voix_in', 'trafic_data_in', 'parc',
       'parc_data', 'parc_2g', 'parc_3g', 'parc_4g', 'parc_5g', 'parc_other',
       'jour'],
      dtype='object')
[2024-07-26T12:23:21.550+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:148: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final.rename(columns=DAILY_CAPARC_COL, inplace=True)

[2024-07-26T12:23:21.551+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:149: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["trafic_data_in_mo"] = df_final["trafic_data_in"] / 1000

[2024-07-26T12:23:21.552+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:150: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["ca_norm"] = None

[2024-07-26T12:23:21.552+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:151: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["ca_mtd"] = None

[2024-07-26T12:23:21.553+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:152: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["segment"] = None

[2024-07-26T12:23:21.554+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:153: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["previous_segment"] = None

[2024-07-26T12:23:21.554+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:154: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["evolution_segment"] = None

[2024-07-26T12:23:21.554+0000] {logging_mixin.py:188} INFO - 6
[2024-07-26T12:23:21.555+0000] {logging_mixin.py:188} INFO - 2024-06-02 00:00:00
[2024-07-26T12:23:21.568+0000] {motower_daily.py:200} INFO - ADD  SEGMENT
[2024-07-26T12:23:21.773+0000] {motower_daily.py:205} INFO - DATA VALIDATION AFTER MERGING
[2024-07-26T12:23:21.773+0000] {data_validation.py:28} INFO - START VALIDATION 
[2024-07-26T12:23:21.774+0000] {data_validation.py:40} INFO - VALID ACTIFS SITES 3107
[2024-07-26T12:23:21.784+0000] {motower_daily.py:216} INFO - DAILY KPI -         jour       ca_voix      ca_data  parc_global  parc_data    parc_2g   parc_3g    parc_4g   parc_5g  autre_parc      ca_total
0 2024-06-02  4.705111e+08  699688383.6   14776871.0  8935471.0  3821885.0  122369.0  3167222.0  214239.0    447997.0  1.215856e+09
[2024-07-26T12:23:21.785+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_total
[2024-07-26T12:23:21.786+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_total ARE VALID
[2024-07-26T12:23:21.786+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_voix
[2024-07-26T12:23:21.787+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_voix ARE VALID
[2024-07-26T12:23:21.787+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_data
[2024-07-26T12:23:21.788+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_data ARE VALID
[2024-07-26T12:23:21.788+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_global
[2024-07-26T12:23:21.789+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_global ARE VALID
[2024-07-26T12:23:21.790+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_data
[2024-07-26T12:23:21.790+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_data ARE VALID
[2024-07-26T12:23:21.824+0000] {logging_mixin.py:188} INFO -         jour code_oci  ...  previous_segment evolution_segment
0 2024-06-02  OCI2831  ...              None              None
1 2024-06-02  OCI3257  ...              None              None
2 2024-06-02  OCI3428  ...              None              None
3 2024-06-02  OCI2587  ...              None              None
4 2024-06-02  OCI3260  ...              None              None

[5 rows x 38 columns]
[2024-07-26T12:23:21.857+0000] {logging_mixin.py:188} INFO -         jour code_oci  ...  previous_segment evolution_segment
0 2024-06-02  OCI2831  ...              None              None
1 2024-06-02  OCI3257  ...              None              None
2 2024-06-02  OCI3428  ...              None              None
3 2024-06-02  OCI2587  ...              None              None
4 2024-06-02  OCI3260  ...              None              None

[5 rows x 38 columns]
[2024-07-26T12:23:21.868+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/custom_dags/motower_daily.py:133: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_faits['mois'] = data["jour"].dt.month

[2024-07-26T12:23:21.870+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/custom_dags/motower_daily.py:134: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_faits['annee'] = data["jour"].dt.year

[2024-07-26T12:23:23.323+0000] {python.py:237} INFO - Done. Returned value was: None
[2024-07-26T12:23:23.324+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-07-26T12:23:23.335+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=motower_daily_prod, task_id=motower_dcaparc, run_id=scheduled__2024-06-03T06:00:00+00:00, execution_date=20240603T060000, start_date=20240726T122321, end_date=20240726T122323
[2024-07-26T12:23:23.723+0000] {local_task_job_runner.py:243} INFO - Task exited with return code 0
[2024-07-26T12:23:23.744+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-26T12:23:23.747+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-07-26T12:29:06.522+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-07-26T12:29:06.588+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [queued]>
[2024-07-26T12:29:06.605+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [queued]>
[2024-07-26T12:29:06.605+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-07-26T12:29:06.629+0000] {taskinstance.py:2330} INFO - Executing <Task(PythonOperator): motower_dcaparc> on 2024-06-03 06:00:00+00:00
[2024-07-26T12:29:06.645+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:62: DeprecationWarning: This process (pid=2316) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-07-26T12:29:06.647+0000] {standard_task_runner.py:64} INFO - Started process 2335 to run task
[2024-07-26T12:29:06.647+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'motower_daily_prod', 'motower_dcaparc', 'scheduled__2024-06-03T06:00:00+00:00', '--job-id', '700', '--raw', '--subdir', 'DAGS_FOLDER/gps/custom_dags/motower_daily.py', '--cfg-path', '/tmp/tmpgg6415y6']
[2024-07-26T12:29:06.650+0000] {standard_task_runner.py:91} INFO - Job 700: Subtask motower_dcaparc
[2024-07-26T12:29:06.763+0000] {task_command.py:426} INFO - Running <TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [running]> on host 88c2b04746a4
[2024-07-26T12:29:06.913+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_EMAIL='richmond.kongo@orange.com,assane.diop@orange.com,cyrille1.danho@orange.com,mohamed2.sylla@orange.com,amadou.diomande@orange.com,Jonas.kouame@orange.com,armand.kablan@orange.com,anicet.azombade@orange.com,etienne.kouadio@orange.com,bertine.kouakou@orange.com,florentine.kouakou@orange.com,ange.phaceli@orange.com,soulegame.soro@orange.com,innocent.yengo@orange.com' AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='motower_daily_prod' AIRFLOW_CTX_TASK_ID='motower_dcaparc' AIRFLOW_CTX_EXECUTION_DATE='2024-06-03T06:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-06-03T06:00:00+00:00'
[2024-07-26T12:29:06.915+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-07-26T12:29:06.942+0000] {motower_daily.py:106} INFO - get last modified bdd sites cleaned
[2024-07-26T12:29:06.961+0000] {motower_daily.py:117} INFO - READING BASE_SITES-cleaned/2024/06/02.csv
[2024-07-26T12:29:07.041+0000] {data_validation.py:28} INFO - START VALIDATION 
[2024-07-26T12:29:07.043+0000] {data_validation.py:40} INFO - VALID ACTIFS SITES 3107
[2024-07-26T12:29:07.044+0000] {motower_daily.py:127} INFO - GET CA PARC FILE OF THE DAY 2024-06-02
[2024-07-26T12:29:07.044+0000] {motower_daily.py:131} INFO - READING ca-parc/2024/06/02.csv
[2024-07-26T12:29:07.073+0000] {motower_daily.py:136} INFO - DAILY KPI -      day_id       ca_voix       ca_data      parc  parc_data   parc_2g  parc_3g  parc_4g  parc_5g  parc_other      ca_total
0  20240602  4.822626e+08  7.120804e+08  16714097    9177438  12057840   876499  5949531   319188     1385238  1.241494e+09
[2024-07-26T12:29:07.074+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_total
[2024-07-26T12:29:07.075+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_total ARE VALID
[2024-07-26T12:29:07.075+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_voix
[2024-07-26T12:29:07.076+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_voix ARE VALID
[2024-07-26T12:29:07.077+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_data
[2024-07-26T12:29:07.077+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_data ARE VALID
[2024-07-26T12:29:07.078+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc
[2024-07-26T12:29:07.079+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc ARE VALID
[2024-07-26T12:29:07.079+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_data
[2024-07-26T12:29:07.080+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_data ARE VALID
[2024-07-26T12:29:07.080+0000] {motower_daily.py:139} INFO - MERGING BDD AND CA
[2024-07-26T12:29:07.084+0000] {motower_daily.py:141} INFO - prepare final daily data
[2024-07-26T12:29:07.086+0000] {logging_mixin.py:188} INFO - Index(['site', 'site bts', 'site physique', 'code oci', 'gestionnaire',
       'proprietaire', 'autre code', 'code esco', 'code ihs', 'longitude',
       'latitude', 'type du site', 'statut', 'couche en service',
       'technologie sans tdd', 'technologie', 'date mes 2g', 'date mes',
       'date mes 3g', 'date mes 4g', 'annee construction pylone',
       'statut sharing', 'statut proprietaire', 'statut partage',
       'geo localite', 'commune', 'departement', 'region', 'district',
       'partenaires', 'localisation', 'equipementier telecom', 'ville',
       'quartier', 'type baie', 'hauteur batiment', 'tower type',
       'tower location', 'type geolocalite', 'tower height', 'type site ihs',
       'type energie', 'projet', 'id quartier', 'id geolocalite', 'clutter',
       'position site', 'type indoor', 'decoupage', 'sous coloc', 'tenant',
       'type de cable', 'mois', 'code oci id', 'day_id', 'id_site', 'ca_voix',
       'ca_data', 'ca_total', 'trafic_voix_in', 'trafic_data_in', 'parc',
       'parc_data', 'parc_2g', 'parc_3g', 'parc_4g', 'parc_5g', 'parc_other',
       'jour'],
      dtype='object')
[2024-07-26T12:29:07.088+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:148: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final.rename(columns=DAILY_CAPARC_COL, inplace=True)

[2024-07-26T12:29:07.090+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:149: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["trafic_data_in_mo"] = df_final["trafic_data_in"] / 1000

[2024-07-26T12:29:07.090+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:150: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["ca_norm"] = None

[2024-07-26T12:29:07.091+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:151: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["ca_mtd"] = None

[2024-07-26T12:29:07.091+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:152: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["segment"] = None

[2024-07-26T12:29:07.092+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:153: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["previous_segment"] = None

[2024-07-26T12:29:07.093+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:154: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["evolution_segment"] = None

[2024-07-26T12:29:07.093+0000] {logging_mixin.py:188} INFO - 6
[2024-07-26T12:29:07.093+0000] {logging_mixin.py:188} INFO - 2024-06-02 00:00:00
[2024-07-26T12:29:07.109+0000] {motower_daily.py:200} INFO - ADD  SEGMENT
[2024-07-26T12:29:07.357+0000] {motower_daily.py:205} INFO - DATA VALIDATION AFTER MERGING
[2024-07-26T12:29:07.358+0000] {data_validation.py:28} INFO - START VALIDATION 
[2024-07-26T12:29:07.360+0000] {data_validation.py:40} INFO - VALID ACTIFS SITES 3107
[2024-07-26T12:29:07.370+0000] {motower_daily.py:216} INFO - DAILY KPI -         jour       ca_voix      ca_data  parc_global  parc_data    parc_2g   parc_3g    parc_4g   parc_5g  autre_parc      ca_total
0 2024-06-02  4.705111e+08  699688383.6   14776871.0  8935471.0  3821885.0  122369.0  3167222.0  214239.0    447997.0  1.215856e+09
[2024-07-26T12:29:07.371+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_total
[2024-07-26T12:29:07.372+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_total ARE VALID
[2024-07-26T12:29:07.372+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_voix
[2024-07-26T12:29:07.374+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_voix ARE VALID
[2024-07-26T12:29:07.374+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_data
[2024-07-26T12:29:07.376+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_data ARE VALID
[2024-07-26T12:29:07.376+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_global
[2024-07-26T12:29:07.377+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_global ARE VALID
[2024-07-26T12:29:07.378+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_data
[2024-07-26T12:29:07.379+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_data ARE VALID
[2024-07-26T12:29:07.419+0000] {logging_mixin.py:188} INFO -         jour code_oci  ...  previous_segment evolution_segment
0 2024-06-02  OCI2831  ...              None              None
1 2024-06-02  OCI3257  ...              None              None
2 2024-06-02  OCI3428  ...              None              None
3 2024-06-02  OCI2587  ...              None              None
4 2024-06-02  OCI3260  ...              None              None

[5 rows x 38 columns]
[2024-07-26T12:29:07.469+0000] {logging_mixin.py:188} INFO -         jour code_oci  ...  previous_segment evolution_segment
0 2024-06-02  OCI2831  ...              None              None
1 2024-06-02  OCI3257  ...              None              None
2 2024-06-02  OCI3428  ...              None              None
3 2024-06-02  OCI2587  ...              None              None
4 2024-06-02  OCI3260  ...              None              None

[5 rows x 38 columns]
[2024-07-26T12:29:07.482+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/custom_dags/motower_daily.py:133: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_faits['mois'] = data["jour"].dt.month

[2024-07-26T12:29:07.484+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/custom_dags/motower_daily.py:134: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_faits['annee'] = data["jour"].dt.year

[2024-07-26T12:29:08.888+0000] {python.py:237} INFO - Done. Returned value was: None
[2024-07-26T12:29:08.889+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-07-26T12:29:08.905+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=motower_daily_prod, task_id=motower_dcaparc, run_id=scheduled__2024-06-03T06:00:00+00:00, execution_date=20240603T060000, start_date=20240726T122906, end_date=20240726T122908
[2024-07-26T12:29:08.961+0000] {local_task_job_runner.py:243} INFO - Task exited with return code 0
[2024-07-26T12:29:08.983+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-26T12:29:08.985+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-07-26T12:39:52.711+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-07-26T12:39:52.750+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [queued]>
[2024-07-26T12:39:52.763+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [queued]>
[2024-07-26T12:39:52.764+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-07-26T12:39:52.782+0000] {taskinstance.py:2330} INFO - Executing <Task(PythonOperator): motower_dcaparc> on 2024-06-03 06:00:00+00:00
[2024-07-26T12:39:52.798+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:62: DeprecationWarning: This process (pid=163) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-07-26T12:39:52.799+0000] {standard_task_runner.py:64} INFO - Started process 175 to run task
[2024-07-26T12:39:52.799+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'motower_daily_prod', 'motower_dcaparc', 'scheduled__2024-06-03T06:00:00+00:00', '--job-id', '35', '--raw', '--subdir', 'DAGS_FOLDER/gps/custom_dags/motower_daily.py', '--cfg-path', '/tmp/tmpg6jyzvf1']
[2024-07-26T12:39:52.801+0000] {standard_task_runner.py:91} INFO - Job 35: Subtask motower_dcaparc
[2024-07-26T12:39:52.862+0000] {task_command.py:426} INFO - Running <TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [running]> on host e824106b656d
[2024-07-26T12:39:52.991+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_EMAIL='richmond.kongo@orange.com,assane.diop@orange.com,cyrille1.danho@orange.com,mohamed2.sylla@orange.com,amadou.diomande@orange.com,Jonas.kouame@orange.com,armand.kablan@orange.com,anicet.azombade@orange.com,etienne.kouadio@orange.com,bertine.kouakou@orange.com,florentine.kouakou@orange.com,ange.phaceli@orange.com,soulegame.soro@orange.com,innocent.yengo@orange.com' AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='motower_daily_prod' AIRFLOW_CTX_TASK_ID='motower_dcaparc' AIRFLOW_CTX_EXECUTION_DATE='2024-06-03T06:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-06-03T06:00:00+00:00'
[2024-07-26T12:39:52.993+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-07-26T12:39:53.015+0000] {motower_daily.py:106} INFO - get last modified bdd sites cleaned
[2024-07-26T12:39:53.028+0000] {motower_daily.py:117} INFO - READING BASE_SITES-cleaned/2024/06/02.csv
[2024-07-26T12:39:53.110+0000] {data_validation.py:28} INFO - START VALIDATION 
[2024-07-26T12:39:53.112+0000] {data_validation.py:40} INFO - VALID ACTIFS SITES 3107
[2024-07-26T12:39:53.112+0000] {motower_daily.py:127} INFO - GET CA PARC FILE OF THE DAY 2024-06-02
[2024-07-26T12:39:53.113+0000] {motower_daily.py:131} INFO - READING ca-parc/2024/06/02.csv
[2024-07-26T12:39:53.141+0000] {motower_daily.py:136} INFO - DAILY KPI -      day_id       ca_voix       ca_data      parc  parc_data   parc_2g  parc_3g  parc_4g  parc_5g  parc_other      ca_total
0  20240602  4.822626e+08  7.120804e+08  16714097    9177438  12057840   876499  5949531   319188     1385238  1.241494e+09
[2024-07-26T12:39:53.142+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_total
[2024-07-26T12:39:53.143+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_total ARE VALID
[2024-07-26T12:39:53.144+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_voix
[2024-07-26T12:39:53.145+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_voix ARE VALID
[2024-07-26T12:39:53.145+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_data
[2024-07-26T12:39:53.146+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_data ARE VALID
[2024-07-26T12:39:53.146+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc
[2024-07-26T12:39:53.147+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc ARE VALID
[2024-07-26T12:39:53.148+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_data
[2024-07-26T12:39:53.148+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_data ARE VALID
[2024-07-26T12:39:53.149+0000] {motower_daily.py:139} INFO - MERGING BDD AND CA
[2024-07-26T12:39:53.154+0000] {motower_daily.py:141} INFO - prepare final daily data
[2024-07-26T12:39:53.156+0000] {logging_mixin.py:188} INFO - Index(['site', 'site bts', 'site physique', 'code oci', 'gestionnaire',
       'proprietaire', 'autre code', 'code esco', 'code ihs', 'longitude',
       'latitude', 'type du site', 'statut', 'couche en service',
       'technologie sans tdd', 'technologie', 'date mes 2g', 'date mes',
       'date mes 3g', 'date mes 4g', 'annee construction pylone',
       'statut sharing', 'statut proprietaire', 'statut partage',
       'geo localite', 'commune', 'departement', 'region', 'district',
       'partenaires', 'localisation', 'equipementier telecom', 'ville',
       'quartier', 'type baie', 'hauteur batiment', 'tower type',
       'tower location', 'type geolocalite', 'tower height', 'type site ihs',
       'type energie', 'projet', 'id quartier', 'id geolocalite', 'clutter',
       'position site', 'type indoor', 'decoupage', 'sous coloc', 'tenant',
       'type de cable', 'mois', 'code oci id', 'day_id', 'id_site', 'ca_voix',
       'ca_data', 'ca_total', 'trafic_voix_in', 'trafic_data_in', 'parc',
       'parc_data', 'parc_2g', 'parc_3g', 'parc_4g', 'parc_5g', 'parc_other',
       'jour'],
      dtype='object')
[2024-07-26T12:39:53.159+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:148: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final.rename(columns=DAILY_CAPARC_COL, inplace=True)

[2024-07-26T12:39:53.160+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:149: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["trafic_data_in_mo"] = df_final["trafic_data_in"] / 1000

[2024-07-26T12:39:53.161+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:150: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["ca_norm"] = None

[2024-07-26T12:39:53.161+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:151: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["ca_mtd"] = None

[2024-07-26T12:39:53.162+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:152: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["segment"] = None

[2024-07-26T12:39:53.163+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:153: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["previous_segment"] = None

[2024-07-26T12:39:53.163+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:154: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["evolution_segment"] = None

[2024-07-26T12:39:53.163+0000] {logging_mixin.py:188} INFO - 6
[2024-07-26T12:39:53.164+0000] {logging_mixin.py:188} INFO - 2024-06-02 00:00:00
[2024-07-26T12:39:53.174+0000] {motower_daily.py:200} INFO - ADD  SEGMENT
[2024-07-26T12:39:53.375+0000] {motower_daily.py:205} INFO - DATA VALIDATION AFTER MERGING
[2024-07-26T12:39:53.375+0000] {data_validation.py:28} INFO - START VALIDATION 
[2024-07-26T12:39:53.376+0000] {data_validation.py:40} INFO - VALID ACTIFS SITES 3107
[2024-07-26T12:39:53.383+0000] {motower_daily.py:216} INFO - DAILY KPI -         jour       ca_voix      ca_data  parc_global  parc_data    parc_2g   parc_3g    parc_4g   parc_5g  autre_parc      ca_total
0 2024-06-02  4.705111e+08  699688383.6   14776871.0  8935471.0  3821885.0  122369.0  3167222.0  214239.0    447997.0  1.215856e+09
[2024-07-26T12:39:53.384+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_total
[2024-07-26T12:39:53.384+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_total ARE VALID
[2024-07-26T12:39:53.384+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_voix
[2024-07-26T12:39:53.385+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_voix ARE VALID
[2024-07-26T12:39:53.385+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_data
[2024-07-26T12:39:53.386+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_data ARE VALID
[2024-07-26T12:39:53.386+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_global
[2024-07-26T12:39:53.387+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_global ARE VALID
[2024-07-26T12:39:53.387+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_data
[2024-07-26T12:39:53.388+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_data ARE VALID
[2024-07-26T12:39:53.412+0000] {logging_mixin.py:188} INFO -         jour code_oci  ...  previous_segment evolution_segment
0 2024-06-02  OCI2831  ...              None              None
1 2024-06-02  OCI3257  ...              None              None
2 2024-06-02  OCI3428  ...              None              None
3 2024-06-02  OCI2587  ...              None              None
4 2024-06-02  OCI3260  ...              None              None

[5 rows x 38 columns]
[2024-07-26T12:39:53.436+0000] {logging_mixin.py:188} INFO -         jour code_oci  ...  previous_segment evolution_segment
0 2024-06-02  OCI2831  ...              None              None
1 2024-06-02  OCI3257  ...              None              None
2 2024-06-02  OCI3428  ...              None              None
3 2024-06-02  OCI2587  ...              None              None
4 2024-06-02  OCI3260  ...              None              None

[5 rows x 38 columns]
[2024-07-26T12:39:53.444+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/custom_dags/motower_daily.py:137: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_faits['mois'] = data["jour"].dt.month

[2024-07-26T12:39:53.445+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/custom_dags/motower_daily.py:138: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_faits['annee'] = data["jour"].dt.year

[2024-07-26T12:39:54.851+0000] {python.py:237} INFO - Done. Returned value was: None
[2024-07-26T12:39:54.852+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-07-26T12:39:54.864+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=motower_daily_prod, task_id=motower_dcaparc, run_id=scheduled__2024-06-03T06:00:00+00:00, execution_date=20240603T060000, start_date=20240726T123952, end_date=20240726T123954
[2024-07-26T12:39:54.912+0000] {local_task_job_runner.py:243} INFO - Task exited with return code 0
[2024-07-26T12:39:54.931+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-26T12:39:54.933+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-07-26T12:46:03.261+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-07-26T12:46:03.307+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [queued]>
[2024-07-26T12:46:03.321+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [queued]>
[2024-07-26T12:46:03.321+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-07-26T12:46:03.768+0000] {taskinstance.py:2330} INFO - Executing <Task(PythonOperator): motower_dcaparc> on 2024-06-03 06:00:00+00:00
[2024-07-26T12:46:03.787+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:62: DeprecationWarning: This process (pid=625) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-07-26T12:46:03.789+0000] {standard_task_runner.py:64} INFO - Started process 647 to run task
[2024-07-26T12:46:03.789+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'motower_daily_prod', 'motower_dcaparc', 'scheduled__2024-06-03T06:00:00+00:00', '--job-id', '160', '--raw', '--subdir', 'DAGS_FOLDER/gps/custom_dags/motower_daily.py', '--cfg-path', '/tmp/tmp13rpwtj3']
[2024-07-26T12:46:03.791+0000] {standard_task_runner.py:91} INFO - Job 160: Subtask motower_dcaparc
[2024-07-26T12:46:03.860+0000] {task_command.py:426} INFO - Running <TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [running]> on host e824106b656d
[2024-07-26T12:46:04.005+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_EMAIL='richmond.kongo@orange.com,assane.diop@orange.com,cyrille1.danho@orange.com,mohamed2.sylla@orange.com,amadou.diomande@orange.com,Jonas.kouame@orange.com,armand.kablan@orange.com,anicet.azombade@orange.com,etienne.kouadio@orange.com,bertine.kouakou@orange.com,florentine.kouakou@orange.com,ange.phaceli@orange.com,soulegame.soro@orange.com,innocent.yengo@orange.com' AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='motower_daily_prod' AIRFLOW_CTX_TASK_ID='motower_dcaparc' AIRFLOW_CTX_EXECUTION_DATE='2024-06-03T06:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-06-03T06:00:00+00:00'
[2024-07-26T12:46:04.007+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-07-26T12:46:04.028+0000] {motower_daily.py:106} INFO - get last modified bdd sites cleaned
[2024-07-26T12:46:04.042+0000] {motower_daily.py:117} INFO - READING BASE_SITES-cleaned/2024/06/02.csv
[2024-07-26T12:46:04.110+0000] {data_validation.py:28} INFO - START VALIDATION 
[2024-07-26T12:46:04.114+0000] {data_validation.py:40} INFO - VALID ACTIFS SITES 3107
[2024-07-26T12:46:04.115+0000] {motower_daily.py:127} INFO - GET CA PARC FILE OF THE DAY 2024-06-02
[2024-07-26T12:46:04.115+0000] {motower_daily.py:131} INFO - READING ca-parc/2024/06/02.csv
[2024-07-26T12:46:04.155+0000] {motower_daily.py:136} INFO - DAILY KPI -      day_id       ca_voix       ca_data      parc  parc_data   parc_2g  parc_3g  parc_4g  parc_5g  parc_other      ca_total
0  20240602  4.822626e+08  7.120804e+08  16714097    9177438  12057840   876499  5949531   319188     1385238  1.241494e+09
[2024-07-26T12:46:04.156+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_total
[2024-07-26T12:46:04.158+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_total ARE VALID
[2024-07-26T12:46:04.159+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_voix
[2024-07-26T12:46:04.161+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_voix ARE VALID
[2024-07-26T12:46:04.162+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_data
[2024-07-26T12:46:04.163+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_data ARE VALID
[2024-07-26T12:46:04.164+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc
[2024-07-26T12:46:04.165+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc ARE VALID
[2024-07-26T12:46:04.166+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_data
[2024-07-26T12:46:04.167+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_data ARE VALID
[2024-07-26T12:46:04.168+0000] {motower_daily.py:139} INFO - MERGING BDD AND CA
[2024-07-26T12:46:04.172+0000] {motower_daily.py:141} INFO - prepare final daily data
[2024-07-26T12:46:04.174+0000] {logging_mixin.py:188} INFO - Index(['site', 'site bts', 'site physique', 'code oci', 'gestionnaire',
       'proprietaire', 'autre code', 'code esco', 'code ihs', 'longitude',
       'latitude', 'type du site', 'statut', 'couche en service',
       'technologie sans tdd', 'technologie', 'date mes 2g', 'date mes',
       'date mes 3g', 'date mes 4g', 'annee construction pylone',
       'statut sharing', 'statut proprietaire', 'statut partage',
       'geo localite', 'commune', 'departement', 'region', 'district',
       'partenaires', 'localisation', 'equipementier telecom', 'ville',
       'quartier', 'type baie', 'hauteur batiment', 'tower type',
       'tower location', 'type geolocalite', 'tower height', 'type site ihs',
       'type energie', 'projet', 'id quartier', 'id geolocalite', 'clutter',
       'position site', 'type indoor', 'decoupage', 'sous coloc', 'tenant',
       'type de cable', 'mois', 'code oci id', 'day_id', 'id_site', 'ca_voix',
       'ca_data', 'ca_total', 'trafic_voix_in', 'trafic_data_in', 'parc',
       'parc_data', 'parc_2g', 'parc_3g', 'parc_4g', 'parc_5g', 'parc_other',
       'jour'],
      dtype='object')
[2024-07-26T12:46:04.177+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:148: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final.rename(columns=DAILY_CAPARC_COL, inplace=True)

[2024-07-26T12:46:04.178+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:149: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["trafic_data_in_mo"] = df_final["trafic_data_in"] / 1000

[2024-07-26T12:46:04.179+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:150: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["ca_norm"] = None

[2024-07-26T12:46:04.180+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:151: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["ca_mtd"] = None

[2024-07-26T12:46:04.180+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:152: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["segment"] = None

[2024-07-26T12:46:04.181+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:153: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["previous_segment"] = None

[2024-07-26T12:46:04.181+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:154: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["evolution_segment"] = None

[2024-07-26T12:46:04.182+0000] {logging_mixin.py:188} INFO - 6
[2024-07-26T12:46:04.182+0000] {logging_mixin.py:188} INFO - 2024-06-02 00:00:00
[2024-07-26T12:46:04.195+0000] {motower_daily.py:200} INFO - ADD  SEGMENT
[2024-07-26T12:46:04.453+0000] {motower_daily.py:205} INFO - DATA VALIDATION AFTER MERGING
[2024-07-26T12:46:04.455+0000] {data_validation.py:28} INFO - START VALIDATION 
[2024-07-26T12:46:04.457+0000] {data_validation.py:40} INFO - VALID ACTIFS SITES 3107
[2024-07-26T12:46:04.470+0000] {motower_daily.py:216} INFO - DAILY KPI -         jour       ca_voix      ca_data  parc_global  parc_data    parc_2g   parc_3g    parc_4g   parc_5g  autre_parc      ca_total
0 2024-06-02  4.705111e+08  699688383.6   14776871.0  8935471.0  3821885.0  122369.0  3167222.0  214239.0    447997.0  1.215856e+09
[2024-07-26T12:46:04.471+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_total
[2024-07-26T12:46:04.474+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_total ARE VALID
[2024-07-26T12:46:04.475+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_voix
[2024-07-26T12:46:04.477+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_voix ARE VALID
[2024-07-26T12:46:04.478+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_data
[2024-07-26T12:46:04.480+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_data ARE VALID
[2024-07-26T12:46:04.481+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_global
[2024-07-26T12:46:04.482+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_global ARE VALID
[2024-07-26T12:46:04.483+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_data
[2024-07-26T12:46:04.485+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_data ARE VALID
[2024-07-26T12:46:04.530+0000] {logging_mixin.py:188} INFO -         jour code_oci  ...  previous_segment evolution_segment
0 2024-06-02  OCI2831  ...              None              None
1 2024-06-02  OCI3257  ...              None              None
2 2024-06-02  OCI3428  ...              None              None
3 2024-06-02  OCI2587  ...              None              None
4 2024-06-02  OCI3260  ...              None              None

[5 rows x 38 columns]
[2024-07-26T12:46:04.580+0000] {logging_mixin.py:188} INFO -         jour code_oci  ...  previous_segment evolution_segment
0 2024-06-02  OCI2831  ...              None              None
1 2024-06-02  OCI3257  ...              None              None
2 2024-06-02  OCI3428  ...              None              None
3 2024-06-02  OCI2587  ...              None              None
4 2024-06-02  OCI3260  ...              None              None

[5 rows x 38 columns]
[2024-07-26T12:46:04.593+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/custom_dags/motower_daily.py:139: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_faits['mois'] = data["jour"].dt.month

[2024-07-26T12:46:04.595+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/custom_dags/motower_daily.py:140: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_faits['annee'] = data["jour"].dt.year

[2024-07-26T12:46:06.176+0000] {python.py:237} INFO - Done. Returned value was: None
[2024-07-26T12:46:06.177+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-07-26T12:46:06.188+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=motower_daily_prod, task_id=motower_dcaparc, run_id=scheduled__2024-06-03T06:00:00+00:00, execution_date=20240603T060000, start_date=20240726T124603, end_date=20240726T124606
[2024-07-26T12:46:06.251+0000] {local_task_job_runner.py:243} INFO - Task exited with return code 0
[2024-07-26T12:46:06.261+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-07-26T12:50:33.646+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-07-26T12:50:33.690+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [queued]>
[2024-07-26T12:50:33.703+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [queued]>
[2024-07-26T12:50:33.704+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-07-26T12:50:33.719+0000] {taskinstance.py:2330} INFO - Executing <Task(PythonOperator): motower_dcaparc> on 2024-06-03 06:00:00+00:00
[2024-07-26T12:50:33.733+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:62: DeprecationWarning: This process (pid=1107) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-07-26T12:50:33.735+0000] {standard_task_runner.py:64} INFO - Started process 1120 to run task
[2024-07-26T12:50:33.737+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'motower_daily_prod', 'motower_dcaparc', 'scheduled__2024-06-03T06:00:00+00:00', '--job-id', '297', '--raw', '--subdir', 'DAGS_FOLDER/gps/custom_dags/motower_daily.py', '--cfg-path', '/tmp/tmpl78hltmj']
[2024-07-26T12:50:33.739+0000] {standard_task_runner.py:91} INFO - Job 297: Subtask motower_dcaparc
[2024-07-26T12:50:33.799+0000] {task_command.py:426} INFO - Running <TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [running]> on host e824106b656d
[2024-07-26T12:50:33.894+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_EMAIL='richmond.kongo@orange.com,assane.diop@orange.com,cyrille1.danho@orange.com,mohamed2.sylla@orange.com,amadou.diomande@orange.com,Jonas.kouame@orange.com,armand.kablan@orange.com,anicet.azombade@orange.com,etienne.kouadio@orange.com,bertine.kouakou@orange.com,florentine.kouakou@orange.com,ange.phaceli@orange.com,soulegame.soro@orange.com,innocent.yengo@orange.com' AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='motower_daily_prod' AIRFLOW_CTX_TASK_ID='motower_dcaparc' AIRFLOW_CTX_EXECUTION_DATE='2024-06-03T06:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-06-03T06:00:00+00:00'
[2024-07-26T12:50:33.895+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-07-26T12:50:33.912+0000] {motower_daily.py:106} INFO - get last modified bdd sites cleaned
[2024-07-26T12:50:33.926+0000] {motower_daily.py:117} INFO - READING BASE_SITES-cleaned/2024/06/02.csv
[2024-07-26T12:50:33.995+0000] {data_validation.py:28} INFO - START VALIDATION 
[2024-07-26T12:50:33.998+0000] {data_validation.py:40} INFO - VALID ACTIFS SITES 3107
[2024-07-26T12:50:34.000+0000] {motower_daily.py:127} INFO - GET CA PARC FILE OF THE DAY 2024-06-02
[2024-07-26T12:50:34.000+0000] {motower_daily.py:131} INFO - READING ca-parc/2024/06/02.csv
[2024-07-26T12:50:34.028+0000] {motower_daily.py:136} INFO - DAILY KPI -      day_id       ca_voix       ca_data      parc  parc_data   parc_2g  parc_3g  parc_4g  parc_5g  parc_other      ca_total
0  20240602  4.822626e+08  7.120804e+08  16714097    9177438  12057840   876499  5949531   319188     1385238  1.241494e+09
[2024-07-26T12:50:34.028+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_total
[2024-07-26T12:50:34.030+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_total ARE VALID
[2024-07-26T12:50:34.030+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_voix
[2024-07-26T12:50:34.031+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_voix ARE VALID
[2024-07-26T12:50:34.032+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_data
[2024-07-26T12:50:34.033+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_data ARE VALID
[2024-07-26T12:50:34.034+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc
[2024-07-26T12:50:34.034+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc ARE VALID
[2024-07-26T12:50:34.035+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_data
[2024-07-26T12:50:34.035+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_data ARE VALID
[2024-07-26T12:50:34.036+0000] {motower_daily.py:139} INFO - MERGING BDD AND CA
[2024-07-26T12:50:34.040+0000] {motower_daily.py:141} INFO - prepare final daily data
[2024-07-26T12:50:34.041+0000] {logging_mixin.py:188} INFO - Index(['site', 'site bts', 'site physique', 'code oci', 'gestionnaire',
       'proprietaire', 'autre code', 'code esco', 'code ihs', 'longitude',
       'latitude', 'type du site', 'statut', 'couche en service',
       'technologie sans tdd', 'technologie', 'date mes 2g', 'date mes',
       'date mes 3g', 'date mes 4g', 'annee construction pylone',
       'statut sharing', 'statut proprietaire', 'statut partage',
       'geo localite', 'commune', 'departement', 'region', 'district',
       'partenaires', 'localisation', 'equipementier telecom', 'ville',
       'quartier', 'type baie', 'hauteur batiment', 'tower type',
       'tower location', 'type geolocalite', 'tower height', 'type site ihs',
       'type energie', 'projet', 'id quartier', 'id geolocalite', 'clutter',
       'position site', 'type indoor', 'decoupage', 'sous coloc', 'tenant',
       'type de cable', 'mois', 'code oci id', 'day_id', 'id_site', 'ca_voix',
       'ca_data', 'ca_total', 'trafic_voix_in', 'trafic_data_in', 'parc',
       'parc_data', 'parc_2g', 'parc_3g', 'parc_4g', 'parc_5g', 'parc_other',
       'jour'],
      dtype='object')
[2024-07-26T12:50:34.044+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:148: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final.rename(columns=DAILY_CAPARC_COL, inplace=True)

[2024-07-26T12:50:34.045+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:149: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["trafic_data_in_mo"] = df_final["trafic_data_in"] / 1000

[2024-07-26T12:50:34.046+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:150: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["ca_norm"] = None

[2024-07-26T12:50:34.046+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:151: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["ca_mtd"] = None

[2024-07-26T12:50:34.047+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:152: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["segment"] = None

[2024-07-26T12:50:34.047+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:153: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["previous_segment"] = None

[2024-07-26T12:50:34.048+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:154: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["evolution_segment"] = None

[2024-07-26T12:50:34.048+0000] {logging_mixin.py:188} INFO - 6
[2024-07-26T12:50:34.048+0000] {logging_mixin.py:188} INFO - 2024-06-02 00:00:00
[2024-07-26T12:50:34.060+0000] {motower_daily.py:200} INFO - ADD  SEGMENT
[2024-07-26T12:50:34.301+0000] {motower_daily.py:205} INFO - DATA VALIDATION AFTER MERGING
[2024-07-26T12:50:34.301+0000] {data_validation.py:28} INFO - START VALIDATION 
[2024-07-26T12:50:34.303+0000] {data_validation.py:40} INFO - VALID ACTIFS SITES 3107
[2024-07-26T12:50:34.313+0000] {motower_daily.py:216} INFO - DAILY KPI -         jour       ca_voix      ca_data  parc_global  parc_data    parc_2g   parc_3g    parc_4g   parc_5g  autre_parc      ca_total
0 2024-06-02  4.705111e+08  699688383.6   14776871.0  8935471.0  3821885.0  122369.0  3167222.0  214239.0    447997.0  1.215856e+09
[2024-07-26T12:50:34.313+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_total
[2024-07-26T12:50:34.314+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_total ARE VALID
[2024-07-26T12:50:34.315+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_voix
[2024-07-26T12:50:34.315+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_voix ARE VALID
[2024-07-26T12:50:34.316+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_data
[2024-07-26T12:50:34.316+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_data ARE VALID
[2024-07-26T12:50:34.317+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_global
[2024-07-26T12:50:34.317+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_global ARE VALID
[2024-07-26T12:50:34.318+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_data
[2024-07-26T12:50:34.318+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_data ARE VALID
[2024-07-26T12:50:34.349+0000] {logging_mixin.py:188} INFO -         jour code_oci  ...  previous_segment evolution_segment
0 2024-06-02  OCI2831  ...              None              None
1 2024-06-02  OCI3257  ...              None              None
2 2024-06-02  OCI3428  ...              None              None
3 2024-06-02  OCI2587  ...              None              None
4 2024-06-02  OCI3260  ...              None              None

[5 rows x 38 columns]
[2024-07-26T12:50:34.381+0000] {logging_mixin.py:188} INFO -         jour code_oci  ...  previous_segment evolution_segment
0 2024-06-02  OCI2831  ...              None              None
1 2024-06-02  OCI3257  ...              None              None
2 2024-06-02  OCI3428  ...              None              None
3 2024-06-02  OCI2587  ...              None              None
4 2024-06-02  OCI3260  ...              None              None

[5 rows x 38 columns]
[2024-07-26T12:50:34.391+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/custom_dags/motower_daily.py:139: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_faits['mois'] = data["jour"].dt.month

[2024-07-26T12:50:34.392+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/custom_dags/motower_daily.py:140: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_faits['annee'] = data["jour"].dt.year

[2024-07-26T12:50:35.695+0000] {python.py:237} INFO - Done. Returned value was: None
[2024-07-26T12:50:35.696+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-07-26T12:50:35.707+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=motower_daily_prod, task_id=motower_dcaparc, run_id=scheduled__2024-06-03T06:00:00+00:00, execution_date=20240603T060000, start_date=20240726T125033, end_date=20240726T125035
[2024-07-26T12:50:35.977+0000] {local_task_job_runner.py:243} INFO - Task exited with return code 0
[2024-07-26T12:50:35.998+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-26T12:50:36.000+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-07-26T12:53:37.615+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-07-26T12:53:37.655+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [queued]>
[2024-07-26T12:53:37.667+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [queued]>
[2024-07-26T12:53:37.667+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-07-26T12:53:37.686+0000] {taskinstance.py:2330} INFO - Executing <Task(PythonOperator): motower_dcaparc> on 2024-06-03 06:00:00+00:00
[2024-07-26T12:53:37.705+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:62: DeprecationWarning: This process (pid=1579) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-07-26T12:53:37.707+0000] {standard_task_runner.py:64} INFO - Started process 1598 to run task
[2024-07-26T12:53:37.708+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'motower_daily_prod', 'motower_dcaparc', 'scheduled__2024-06-03T06:00:00+00:00', '--job-id', '447', '--raw', '--subdir', 'DAGS_FOLDER/gps/custom_dags/motower_daily.py', '--cfg-path', '/tmp/tmpymde83rf']
[2024-07-26T12:53:37.711+0000] {standard_task_runner.py:91} INFO - Job 447: Subtask motower_dcaparc
[2024-07-26T12:53:37.775+0000] {task_command.py:426} INFO - Running <TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [running]> on host e824106b656d
[2024-07-26T12:53:37.902+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_EMAIL='richmond.kongo@orange.com,assane.diop@orange.com,cyrille1.danho@orange.com,mohamed2.sylla@orange.com,amadou.diomande@orange.com,Jonas.kouame@orange.com,armand.kablan@orange.com,anicet.azombade@orange.com,etienne.kouadio@orange.com,bertine.kouakou@orange.com,florentine.kouakou@orange.com,ange.phaceli@orange.com,soulegame.soro@orange.com,innocent.yengo@orange.com' AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='motower_daily_prod' AIRFLOW_CTX_TASK_ID='motower_dcaparc' AIRFLOW_CTX_EXECUTION_DATE='2024-06-03T06:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-06-03T06:00:00+00:00'
[2024-07-26T12:53:37.904+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-07-26T12:53:37.926+0000] {motower_daily.py:106} INFO - get last modified bdd sites cleaned
[2024-07-26T12:53:37.942+0000] {motower_daily.py:117} INFO - READING BASE_SITES-cleaned/2024/06/02.csv
[2024-07-26T12:53:38.018+0000] {data_validation.py:28} INFO - START VALIDATION 
[2024-07-26T12:53:38.020+0000] {data_validation.py:40} INFO - VALID ACTIFS SITES 3107
[2024-07-26T12:53:38.021+0000] {motower_daily.py:127} INFO - GET CA PARC FILE OF THE DAY 2024-06-02
[2024-07-26T12:53:38.021+0000] {motower_daily.py:131} INFO - READING ca-parc/2024/06/02.csv
[2024-07-26T12:53:38.051+0000] {motower_daily.py:136} INFO - DAILY KPI -      day_id       ca_voix       ca_data      parc  parc_data   parc_2g  parc_3g  parc_4g  parc_5g  parc_other      ca_total
0  20240602  4.822626e+08  7.120804e+08  16714097    9177438  12057840   876499  5949531   319188     1385238  1.241494e+09
[2024-07-26T12:53:38.051+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_total
[2024-07-26T12:53:38.052+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_total ARE VALID
[2024-07-26T12:53:38.053+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_voix
[2024-07-26T12:53:38.054+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_voix ARE VALID
[2024-07-26T12:53:38.054+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_data
[2024-07-26T12:53:38.055+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_data ARE VALID
[2024-07-26T12:53:38.055+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc
[2024-07-26T12:53:38.055+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc ARE VALID
[2024-07-26T12:53:38.056+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_data
[2024-07-26T12:53:38.056+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_data ARE VALID
[2024-07-26T12:53:38.057+0000] {motower_daily.py:139} INFO - MERGING BDD AND CA
[2024-07-26T12:53:38.061+0000] {motower_daily.py:141} INFO - prepare final daily data
[2024-07-26T12:53:38.063+0000] {logging_mixin.py:188} INFO - Index(['site', 'site bts', 'site physique', 'code oci', 'gestionnaire',
       'proprietaire', 'autre code', 'code esco', 'code ihs', 'longitude',
       'latitude', 'type du site', 'statut', 'couche en service',
       'technologie sans tdd', 'technologie', 'date mes 2g', 'date mes',
       'date mes 3g', 'date mes 4g', 'annee construction pylone',
       'statut sharing', 'statut proprietaire', 'statut partage',
       'geo localite', 'commune', 'departement', 'region', 'district',
       'partenaires', 'localisation', 'equipementier telecom', 'ville',
       'quartier', 'type baie', 'hauteur batiment', 'tower type',
       'tower location', 'type geolocalite', 'tower height', 'type site ihs',
       'type energie', 'projet', 'id quartier', 'id geolocalite', 'clutter',
       'position site', 'type indoor', 'decoupage', 'sous coloc', 'tenant',
       'type de cable', 'mois', 'code oci id', 'day_id', 'id_site', 'ca_voix',
       'ca_data', 'ca_total', 'trafic_voix_in', 'trafic_data_in', 'parc',
       'parc_data', 'parc_2g', 'parc_3g', 'parc_4g', 'parc_5g', 'parc_other',
       'jour'],
      dtype='object')
[2024-07-26T12:53:38.066+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:148: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final.rename(columns=DAILY_CAPARC_COL, inplace=True)

[2024-07-26T12:53:38.067+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:149: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["trafic_data_in_mo"] = df_final["trafic_data_in"] / 1000

[2024-07-26T12:53:38.068+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:150: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["ca_norm"] = None

[2024-07-26T12:53:38.069+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:151: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["ca_mtd"] = None

[2024-07-26T12:53:38.069+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:152: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["segment"] = None

[2024-07-26T12:53:38.070+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:153: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["previous_segment"] = None

[2024-07-26T12:53:38.071+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:154: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["evolution_segment"] = None

[2024-07-26T12:53:38.071+0000] {logging_mixin.py:188} INFO - 6
[2024-07-26T12:53:38.074+0000] {logging_mixin.py:188} INFO - 2024-06-02 00:00:00
[2024-07-26T12:53:38.088+0000] {motower_daily.py:200} INFO - ADD  SEGMENT
[2024-07-26T12:53:38.318+0000] {motower_daily.py:205} INFO - DATA VALIDATION AFTER MERGING
[2024-07-26T12:53:38.319+0000] {data_validation.py:28} INFO - START VALIDATION 
[2024-07-26T12:53:38.320+0000] {data_validation.py:40} INFO - VALID ACTIFS SITES 3107
[2024-07-26T12:53:38.330+0000] {motower_daily.py:216} INFO - DAILY KPI -         jour       ca_voix      ca_data  parc_global  parc_data    parc_2g   parc_3g    parc_4g   parc_5g  autre_parc      ca_total
0 2024-06-02  4.705111e+08  699688383.6   14776871.0  8935471.0  3821885.0  122369.0  3167222.0  214239.0    447997.0  1.215856e+09
[2024-07-26T12:53:38.331+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_total
[2024-07-26T12:53:38.332+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_total ARE VALID
[2024-07-26T12:53:38.332+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_voix
[2024-07-26T12:53:38.333+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_voix ARE VALID
[2024-07-26T12:53:38.333+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_data
[2024-07-26T12:53:38.334+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_data ARE VALID
[2024-07-26T12:53:38.334+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_global
[2024-07-26T12:53:38.335+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_global ARE VALID
[2024-07-26T12:53:38.335+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_data
[2024-07-26T12:53:38.335+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_data ARE VALID
[2024-07-26T12:53:38.366+0000] {logging_mixin.py:188} INFO -         jour code_oci  ...  previous_segment evolution_segment
0 2024-06-02  OCI2831  ...              None              None
1 2024-06-02  OCI3257  ...              None              None
2 2024-06-02  OCI3428  ...              None              None
3 2024-06-02  OCI2587  ...              None              None
4 2024-06-02  OCI3260  ...              None              None

[5 rows x 38 columns]
[2024-07-26T12:53:38.392+0000] {logging_mixin.py:188} INFO -         jour code_oci  ...  previous_segment evolution_segment
0 2024-06-02  OCI2831  ...              None              None
1 2024-06-02  OCI3257  ...              None              None
2 2024-06-02  OCI3428  ...              None              None
3 2024-06-02  OCI2587  ...              None              None
4 2024-06-02  OCI3260  ...              None              None

[5 rows x 38 columns]
[2024-07-26T12:53:38.399+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/custom_dags/motower_daily.py:139: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_faits['mois'] = data["jour"].dt.month

[2024-07-26T12:53:38.400+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/custom_dags/motower_daily.py:140: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_faits['annee'] = data["jour"].dt.year

[2024-07-26T12:53:39.341+0000] {python.py:237} INFO - Done. Returned value was: None
[2024-07-26T12:53:39.342+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-07-26T12:53:39.355+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=motower_daily_prod, task_id=motower_dcaparc, run_id=scheduled__2024-06-03T06:00:00+00:00, execution_date=20240603T060000, start_date=20240726T125337, end_date=20240726T125339
[2024-07-26T12:53:39.406+0000] {local_task_job_runner.py:243} INFO - Task exited with return code 0
[2024-07-26T12:53:39.432+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-26T12:53:39.434+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-07-29T11:48:46.677+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-07-29T11:48:46.970+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [queued]>
[2024-07-29T11:48:46.981+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [queued]>
[2024-07-29T11:48:46.982+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-07-29T11:48:46.996+0000] {taskinstance.py:2330} INFO - Executing <Task(PythonOperator): motower_dcaparc> on 2024-06-03 06:00:00+00:00
[2024-07-29T11:48:47.006+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:62: DeprecationWarning: This process (pid=2346) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-07-29T11:48:47.008+0000] {standard_task_runner.py:64} INFO - Started process 2357 to run task
[2024-07-29T11:48:47.008+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'motower_daily_prod', 'motower_dcaparc', 'scheduled__2024-06-03T06:00:00+00:00', '--job-id', '631', '--raw', '--subdir', 'DAGS_FOLDER/gps/custom_dags/motower_daily.py', '--cfg-path', '/tmp/tmppyricoqy']
[2024-07-29T11:48:47.010+0000] {standard_task_runner.py:91} INFO - Job 631: Subtask motower_dcaparc
[2024-07-29T11:48:47.056+0000] {task_command.py:426} INFO - Running <TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [running]> on host e824106b656d
[2024-07-29T11:48:47.160+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_EMAIL='richmond.kongo@orange.com,assane.diop@orange.com,cyrille1.danho@orange.com,mohamed2.sylla@orange.com,amadou.diomande@orange.com,Jonas.kouame@orange.com,armand.kablan@orange.com,anicet.azombade@orange.com,etienne.kouadio@orange.com,bertine.kouakou@orange.com,florentine.kouakou@orange.com,ange.phaceli@orange.com,soulegame.soro@orange.com,innocent.yengo@orange.com' AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='motower_daily_prod' AIRFLOW_CTX_TASK_ID='motower_dcaparc' AIRFLOW_CTX_EXECUTION_DATE='2024-06-03T06:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-06-03T06:00:00+00:00'
[2024-07-29T11:48:47.161+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-07-29T11:48:47.182+0000] {motower_daily.py:106} INFO - get last modified bdd sites cleaned
[2024-07-29T11:48:47.196+0000] {motower_daily.py:117} INFO - READING BASE_SITES-cleaned/2024/06/02.csv
[2024-07-29T11:48:47.256+0000] {data_validation.py:28} INFO - START VALIDATION 
[2024-07-29T11:48:47.259+0000] {data_validation.py:40} INFO - VALID ACTIFS SITES 3107
[2024-07-29T11:48:47.260+0000] {motower_daily.py:127} INFO - GET CA PARC FILE OF THE DAY 2024-06-02
[2024-07-29T11:48:47.260+0000] {motower_daily.py:131} INFO - READING ca-parc/2024/06/02.csv
[2024-07-29T11:48:47.292+0000] {motower_daily.py:136} INFO - DAILY KPI -      day_id       ca_voix       ca_data      parc  parc_data   parc_2g  parc_3g  parc_4g  parc_5g  parc_other      ca_total
0  20240602  4.822626e+08  7.120804e+08  16714097    9177438  12057840   876499  5949531   319188     1385238  1.241494e+09
[2024-07-29T11:48:47.293+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_total
[2024-07-29T11:48:47.296+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_total ARE VALID
[2024-07-29T11:48:47.297+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_voix
[2024-07-29T11:48:47.299+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_voix ARE VALID
[2024-07-29T11:48:47.299+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_data
[2024-07-29T11:48:47.300+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_data ARE VALID
[2024-07-29T11:48:47.300+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc
[2024-07-29T11:48:47.301+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc ARE VALID
[2024-07-29T11:48:47.302+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_data
[2024-07-29T11:48:47.303+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_data ARE VALID
[2024-07-29T11:48:47.303+0000] {motower_daily.py:139} INFO - MERGING BDD AND CA
[2024-07-29T11:48:47.308+0000] {motower_daily.py:141} INFO - prepare final daily data
[2024-07-29T11:48:47.310+0000] {logging_mixin.py:188} INFO - Index(['site', 'site bts', 'site physique', 'code oci', 'gestionnaire',
       'proprietaire', 'autre code', 'code esco', 'code ihs', 'longitude',
       'latitude', 'type du site', 'statut', 'couche en service',
       'technologie sans tdd', 'technologie', 'date mes 2g', 'date mes',
       'date mes 3g', 'date mes 4g', 'annee construction pylone',
       'statut sharing', 'statut proprietaire', 'statut partage',
       'geo localite', 'commune', 'departement', 'region', 'district',
       'partenaires', 'localisation', 'equipementier telecom', 'ville',
       'quartier', 'type baie', 'hauteur batiment', 'tower type',
       'tower location', 'type geolocalite', 'tower height', 'type site ihs',
       'type energie', 'projet', 'id quartier', 'id geolocalite', 'clutter',
       'position site', 'type indoor', 'decoupage', 'sous coloc', 'tenant',
       'type de cable', 'mois', 'code oci id', 'day_id', 'id_site', 'ca_voix',
       'ca_data', 'ca_total', 'trafic_voix_in', 'trafic_data_in', 'parc',
       'parc_data', 'parc_2g', 'parc_3g', 'parc_4g', 'parc_5g', 'parc_other',
       'jour'],
      dtype='object')
[2024-07-29T11:48:47.313+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:148: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final.rename(columns=DAILY_CAPARC_COL, inplace=True)

[2024-07-29T11:48:47.314+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:149: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["trafic_data_in_mo"] = df_final["trafic_data_in"] / 1000

[2024-07-29T11:48:47.315+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:150: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["ca_norm"] = None

[2024-07-29T11:48:47.315+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:151: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["ca_mtd"] = None

[2024-07-29T11:48:47.316+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:152: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["segment"] = None

[2024-07-29T11:48:47.316+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:153: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["previous_segment"] = None

[2024-07-29T11:48:47.317+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:154: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["evolution_segment"] = None

[2024-07-29T11:48:47.317+0000] {logging_mixin.py:188} INFO - 6
[2024-07-29T11:48:47.317+0000] {logging_mixin.py:188} INFO - 2024-06-02 00:00:00
[2024-07-29T11:48:47.333+0000] {motower_daily.py:200} INFO - ADD  SEGMENT
[2024-07-29T11:48:47.513+0000] {motower_daily.py:205} INFO - DATA VALIDATION AFTER MERGING
[2024-07-29T11:48:47.513+0000] {data_validation.py:28} INFO - START VALIDATION 
[2024-07-29T11:48:47.514+0000] {data_validation.py:40} INFO - VALID ACTIFS SITES 3107
[2024-07-29T11:48:47.521+0000] {motower_daily.py:216} INFO - DAILY KPI -         jour       ca_voix      ca_data  parc_global  parc_data    parc_2g   parc_3g    parc_4g   parc_5g  autre_parc      ca_total
0 2024-06-02  4.705111e+08  699688383.6   14776871.0  8935471.0  3821885.0  122369.0  3167222.0  214239.0    447997.0  1.215856e+09
[2024-07-29T11:48:47.521+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_total
[2024-07-29T11:48:47.522+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_total ARE VALID
[2024-07-29T11:48:47.522+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_voix
[2024-07-29T11:48:47.522+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_voix ARE VALID
[2024-07-29T11:48:47.523+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_data
[2024-07-29T11:48:47.523+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_data ARE VALID
[2024-07-29T11:48:47.523+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_global
[2024-07-29T11:48:47.524+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_global ARE VALID
[2024-07-29T11:48:47.524+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_data
[2024-07-29T11:48:47.524+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_data ARE VALID
[2024-07-29T11:48:47.547+0000] {logging_mixin.py:188} INFO -         jour code_oci  ...  previous_segment evolution_segment
0 2024-06-02  OCI2831  ...              None              None
1 2024-06-02  OCI3257  ...              None              None
2 2024-06-02  OCI3428  ...              None              None
3 2024-06-02  OCI2587  ...              None              None
4 2024-06-02  OCI3260  ...              None              None

[5 rows x 38 columns]
[2024-07-29T11:48:47.568+0000] {logging_mixin.py:188} INFO -         jour code_oci  ...  previous_segment evolution_segment
0 2024-06-02  OCI2831  ...              None              None
1 2024-06-02  OCI3257  ...              None              None
2 2024-06-02  OCI3428  ...              None              None
3 2024-06-02  OCI2587  ...              None              None
4 2024-06-02  OCI3260  ...              None              None

[5 rows x 38 columns]
[2024-07-29T11:48:47.575+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/custom_dags/motower_daily.py:139: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_faits['mois'] = data["jour"].dt.month

[2024-07-29T11:48:47.575+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/custom_dags/motower_daily.py:140: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_faits['annee'] = data["jour"].dt.year

[2024-07-29T11:48:48.345+0000] {python.py:237} INFO - Done. Returned value was: None
[2024-07-29T11:48:48.346+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-07-29T11:48:48.354+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=motower_daily_prod, task_id=motower_dcaparc, run_id=scheduled__2024-06-03T06:00:00+00:00, execution_date=20240603T060000, start_date=20240729T114846, end_date=20240729T114848
[2024-07-29T11:48:48.507+0000] {local_task_job_runner.py:243} INFO - Task exited with return code 0
[2024-07-29T11:48:48.522+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-29T11:48:48.523+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-07-29T11:58:45.860+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-07-29T11:58:46.091+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [queued]>
[2024-07-29T11:58:46.098+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [queued]>
[2024-07-29T11:58:46.099+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-07-29T11:58:46.107+0000] {taskinstance.py:2330} INFO - Executing <Task(PythonOperator): motower_dcaparc> on 2024-06-03 06:00:00+00:00
[2024-07-29T11:58:46.115+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:62: DeprecationWarning: This process (pid=2759) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-07-29T11:58:46.116+0000] {standard_task_runner.py:64} INFO - Started process 2769 to run task
[2024-07-29T11:58:46.117+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'motower_daily_prod', 'motower_dcaparc', 'scheduled__2024-06-03T06:00:00+00:00', '--job-id', '728', '--raw', '--subdir', 'DAGS_FOLDER/gps/custom_dags/motower_daily.py', '--cfg-path', '/tmp/tmppow6pt10']
[2024-07-29T11:58:46.118+0000] {standard_task_runner.py:91} INFO - Job 728: Subtask motower_dcaparc
[2024-07-29T11:58:46.156+0000] {task_command.py:426} INFO - Running <TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [running]> on host e824106b656d
[2024-07-29T11:58:46.236+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_EMAIL='richmond.kongo@orange.com,assane.diop@orange.com,cyrille1.danho@orange.com,mohamed2.sylla@orange.com,amadou.diomande@orange.com,Jonas.kouame@orange.com,armand.kablan@orange.com,anicet.azombade@orange.com,etienne.kouadio@orange.com,bertine.kouakou@orange.com,florentine.kouakou@orange.com,ange.phaceli@orange.com,soulegame.soro@orange.com,innocent.yengo@orange.com' AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='motower_daily_prod' AIRFLOW_CTX_TASK_ID='motower_dcaparc' AIRFLOW_CTX_EXECUTION_DATE='2024-06-03T06:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-06-03T06:00:00+00:00'
[2024-07-29T11:58:46.237+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-07-29T11:58:46.251+0000] {motower_daily.py:106} INFO - get last modified bdd sites cleaned
[2024-07-29T11:58:46.260+0000] {motower_daily.py:117} INFO - READING BASE_SITES-cleaned/2024/06/02.csv
[2024-07-29T11:58:46.302+0000] {data_validation.py:28} INFO - START VALIDATION 
[2024-07-29T11:58:46.304+0000] {data_validation.py:40} INFO - VALID ACTIFS SITES 3107
[2024-07-29T11:58:46.304+0000] {motower_daily.py:127} INFO - GET CA PARC FILE OF THE DAY 2024-06-02
[2024-07-29T11:58:46.304+0000] {motower_daily.py:131} INFO - READING ca-parc/2024/06/02.csv
[2024-07-29T11:58:46.321+0000] {motower_daily.py:136} INFO - DAILY KPI -      day_id       ca_voix       ca_data      parc  parc_data   parc_2g  parc_3g  parc_4g  parc_5g  parc_other      ca_total
0  20240602  4.822626e+08  7.120804e+08  16714097    9177438  12057840   876499  5949531   319188     1385238  1.241494e+09
[2024-07-29T11:58:46.322+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_total
[2024-07-29T11:58:46.323+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_total ARE VALID
[2024-07-29T11:58:46.323+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_voix
[2024-07-29T11:58:46.324+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_voix ARE VALID
[2024-07-29T11:58:46.324+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_data
[2024-07-29T11:58:46.324+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_data ARE VALID
[2024-07-29T11:58:46.324+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc
[2024-07-29T11:58:46.325+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc ARE VALID
[2024-07-29T11:58:46.325+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_data
[2024-07-29T11:58:46.326+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_data ARE VALID
[2024-07-29T11:58:46.326+0000] {motower_daily.py:139} INFO - MERGING BDD AND CA
[2024-07-29T11:58:46.328+0000] {motower_daily.py:141} INFO - prepare final daily data
[2024-07-29T11:58:46.330+0000] {logging_mixin.py:188} INFO - Index(['site', 'site bts', 'site physique', 'code oci', 'gestionnaire',
       'proprietaire', 'autre code', 'code esco', 'code ihs', 'longitude',
       'latitude', 'type du site', 'statut', 'couche en service',
       'technologie sans tdd', 'technologie', 'date mes 2g', 'date mes',
       'date mes 3g', 'date mes 4g', 'annee construction pylone',
       'statut sharing', 'statut proprietaire', 'statut partage',
       'geo localite', 'commune', 'departement', 'region', 'district',
       'partenaires', 'localisation', 'equipementier telecom', 'ville',
       'quartier', 'type baie', 'hauteur batiment', 'tower type',
       'tower location', 'type geolocalite', 'tower height', 'type site ihs',
       'type energie', 'projet', 'id quartier', 'id geolocalite', 'clutter',
       'position site', 'type indoor', 'decoupage', 'sous coloc', 'tenant',
       'type de cable', 'mois', 'code oci id', 'day_id', 'id_site', 'ca_voix',
       'ca_data', 'ca_total', 'trafic_voix_in', 'trafic_data_in', 'parc',
       'parc_data', 'parc_2g', 'parc_3g', 'parc_4g', 'parc_5g', 'parc_other',
       'jour'],
      dtype='object')
[2024-07-29T11:58:46.331+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:148: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final.rename(columns=DAILY_CAPARC_COL, inplace=True)

[2024-07-29T11:58:46.332+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:149: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["trafic_data_in_mo"] = df_final["trafic_data_in"] / 1000

[2024-07-29T11:58:46.332+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:150: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["ca_norm"] = None

[2024-07-29T11:58:46.333+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:151: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["ca_mtd"] = None

[2024-07-29T11:58:46.333+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:152: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["segment"] = None

[2024-07-29T11:58:46.334+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:153: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["previous_segment"] = None

[2024-07-29T11:58:46.334+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:154: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["evolution_segment"] = None

[2024-07-29T11:58:46.334+0000] {logging_mixin.py:188} INFO - 6
[2024-07-29T11:58:46.334+0000] {logging_mixin.py:188} INFO - 2024-06-02 00:00:00
[2024-07-29T11:58:46.342+0000] {motower_daily.py:200} INFO - ADD  SEGMENT
[2024-07-29T11:58:46.481+0000] {motower_daily.py:205} INFO - DATA VALIDATION AFTER MERGING
[2024-07-29T11:58:46.482+0000] {data_validation.py:28} INFO - START VALIDATION 
[2024-07-29T11:58:46.482+0000] {data_validation.py:40} INFO - VALID ACTIFS SITES 3107
[2024-07-29T11:58:46.490+0000] {motower_daily.py:216} INFO - DAILY KPI -         jour       ca_voix      ca_data  parc_global  parc_data    parc_2g   parc_3g    parc_4g   parc_5g  autre_parc      ca_total
0 2024-06-02  4.705111e+08  699688383.6   14776871.0  8935471.0  3821885.0  122369.0  3167222.0  214239.0    447997.0  1.215856e+09
[2024-07-29T11:58:46.490+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_total
[2024-07-29T11:58:46.491+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_total ARE VALID
[2024-07-29T11:58:46.491+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_voix
[2024-07-29T11:58:46.491+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_voix ARE VALID
[2024-07-29T11:58:46.492+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_data
[2024-07-29T11:58:46.492+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_data ARE VALID
[2024-07-29T11:58:46.492+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_global
[2024-07-29T11:58:46.493+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_global ARE VALID
[2024-07-29T11:58:46.493+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_data
[2024-07-29T11:58:46.493+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_data ARE VALID
[2024-07-29T11:58:46.516+0000] {logging_mixin.py:188} INFO -         jour code_oci  ...  previous_segment evolution_segment
0 2024-06-02  OCI2831  ...              None              None
1 2024-06-02  OCI3257  ...              None              None
2 2024-06-02  OCI3428  ...              None              None
3 2024-06-02  OCI2587  ...              None              None
4 2024-06-02  OCI3260  ...              None              None

[5 rows x 38 columns]
[2024-07-29T11:58:46.540+0000] {logging_mixin.py:188} INFO -         jour code_oci  ...  previous_segment evolution_segment
0 2024-06-02  OCI2831  ...              None              None
1 2024-06-02  OCI3257  ...              None              None
2 2024-06-02  OCI3428  ...              None              None
3 2024-06-02  OCI2587  ...              None              None
4 2024-06-02  OCI3260  ...              None              None

[5 rows x 38 columns]
[2024-07-29T11:58:46.548+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/custom_dags/motower_daily.py:139: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_faits['mois'] = data["jour"].dt.month

[2024-07-29T11:58:46.549+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/custom_dags/motower_daily.py:140: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_faits['annee'] = data["jour"].dt.year

[2024-07-29T11:58:48.000+0000] {python.py:237} INFO - Done. Returned value was: None
[2024-07-29T11:58:48.001+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-07-29T11:58:48.021+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=motower_daily_prod, task_id=motower_dcaparc, run_id=scheduled__2024-06-03T06:00:00+00:00, execution_date=20240603T060000, start_date=20240729T115846, end_date=20240729T115848
[2024-07-29T11:58:48.182+0000] {local_task_job_runner.py:243} INFO - Task exited with return code 0
[2024-07-29T11:58:48.201+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-29T11:58:48.202+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2024-07-29T14:31:50.506+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2024-07-29T14:31:50.544+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [queued]>
[2024-07-29T14:31:50.558+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [queued]>
[2024-07-29T14:31:50.559+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2024-07-29T14:31:50.574+0000] {taskinstance.py:2330} INFO - Executing <Task(PythonOperator): motower_dcaparc> on 2024-06-03 06:00:00+00:00
[2024-07-29T14:31:50.587+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:62: DeprecationWarning: This process (pid=778) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2024-07-29T14:31:50.589+0000] {standard_task_runner.py:64} INFO - Started process 793 to run task
[2024-07-29T14:31:50.589+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'motower_daily_prod', 'motower_dcaparc', 'scheduled__2024-06-03T06:00:00+00:00', '--job-id', '1122', '--raw', '--subdir', 'DAGS_FOLDER/gps/custom_dags/motower_daily.py', '--cfg-path', '/tmp/tmpaqk9k0s2']
[2024-07-29T14:31:50.593+0000] {standard_task_runner.py:91} INFO - Job 1122: Subtask motower_dcaparc
[2024-07-29T14:31:50.650+0000] {task_command.py:426} INFO - Running <TaskInstance: motower_daily_prod.motower_dcaparc scheduled__2024-06-03T06:00:00+00:00 [running]> on host e824106b656d
[2024-07-29T14:31:50.768+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_EMAIL='richmond.kongo@orange.com,assane.diop@orange.com,cyrille1.danho@orange.com,mohamed2.sylla@orange.com,amadou.diomande@orange.com,Jonas.kouame@orange.com,armand.kablan@orange.com,anicet.azombade@orange.com,etienne.kouadio@orange.com,bertine.kouakou@orange.com,florentine.kouakou@orange.com,ange.phaceli@orange.com,soulegame.soro@orange.com,innocent.yengo@orange.com' AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='motower_daily_prod' AIRFLOW_CTX_TASK_ID='motower_dcaparc' AIRFLOW_CTX_EXECUTION_DATE='2024-06-03T06:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-06-03T06:00:00+00:00'
[2024-07-29T14:31:50.769+0000] {taskinstance.py:430} INFO - ::endgroup::
[2024-07-29T14:31:50.786+0000] {motower_daily.py:106} INFO - get last modified bdd sites cleaned
[2024-07-29T14:31:50.799+0000] {motower_daily.py:117} INFO - READING BASE_SITES-cleaned/2024/06/02.csv
[2024-07-29T14:31:50.861+0000] {data_validation.py:28} INFO - START VALIDATION 
[2024-07-29T14:31:50.863+0000] {data_validation.py:40} INFO - VALID ACTIFS SITES 3107
[2024-07-29T14:31:50.863+0000] {motower_daily.py:127} INFO - GET CA PARC FILE OF THE DAY 2024-06-02
[2024-07-29T14:31:50.863+0000] {motower_daily.py:131} INFO - READING ca-parc/2024/06/02.csv
[2024-07-29T14:31:50.888+0000] {motower_daily.py:136} INFO - DAILY KPI -      day_id       ca_voix       ca_data      parc  parc_data   parc_2g  parc_3g  parc_4g  parc_5g  parc_other      ca_total
0  20240602  4.822626e+08  7.120804e+08  16714097    9177438  12057840   876499  5949531   319188     1385238  1.241494e+09
[2024-07-29T14:31:50.889+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_total
[2024-07-29T14:31:50.891+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_total ARE VALID
[2024-07-29T14:31:50.891+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_voix
[2024-07-29T14:31:50.892+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_voix ARE VALID
[2024-07-29T14:31:50.892+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_data
[2024-07-29T14:31:50.893+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_data ARE VALID
[2024-07-29T14:31:50.893+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc
[2024-07-29T14:31:50.894+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc ARE VALID
[2024-07-29T14:31:50.894+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_data
[2024-07-29T14:31:50.895+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_data ARE VALID
[2024-07-29T14:31:50.895+0000] {motower_daily.py:139} INFO - MERGING BDD AND CA
[2024-07-29T14:31:50.899+0000] {motower_daily.py:141} INFO - prepare final daily data
[2024-07-29T14:31:50.900+0000] {logging_mixin.py:188} INFO - Index(['site', 'site bts', 'site physique', 'code oci', 'gestionnaire',
       'proprietaire', 'autre code', 'code esco', 'code ihs', 'longitude',
       'latitude', 'type du site', 'statut', 'couche en service',
       'technologie sans tdd', 'technologie', 'date mes 2g', 'date mes',
       'date mes 3g', 'date mes 4g', 'annee construction pylone',
       'statut sharing', 'statut proprietaire', 'statut partage',
       'geo localite', 'commune', 'departement', 'region', 'district',
       'partenaires', 'localisation', 'equipementier telecom', 'ville',
       'quartier', 'type baie', 'hauteur batiment', 'tower type',
       'tower location', 'type geolocalite', 'tower height', 'type site ihs',
       'type energie', 'projet', 'id quartier', 'id geolocalite', 'clutter',
       'position site', 'type indoor', 'decoupage', 'sous coloc', 'tenant',
       'type de cable', 'mois', 'code oci id', 'day_id', 'id_site', 'ca_voix',
       'ca_data', 'ca_total', 'trafic_voix_in', 'trafic_data_in', 'parc',
       'parc_data', 'parc_2g', 'parc_3g', 'parc_4g', 'parc_5g', 'parc_other',
       'jour'],
      dtype='object')
[2024-07-29T14:31:50.902+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:148: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final.rename(columns=DAILY_CAPARC_COL, inplace=True)

[2024-07-29T14:31:50.903+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:149: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["trafic_data_in_mo"] = df_final["trafic_data_in"] / 1000

[2024-07-29T14:31:50.904+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:150: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["ca_norm"] = None

[2024-07-29T14:31:50.905+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:151: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["ca_mtd"] = None

[2024-07-29T14:31:50.905+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:152: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["segment"] = None

[2024-07-29T14:31:50.906+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:153: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["previous_segment"] = None

[2024-07-29T14:31:50.906+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/common/motower_daily.py:154: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_final["evolution_segment"] = None

[2024-07-29T14:31:50.906+0000] {logging_mixin.py:188} INFO - 6
[2024-07-29T14:31:50.907+0000] {logging_mixin.py:188} INFO - 2024-06-02 00:00:00
[2024-07-29T14:31:50.918+0000] {motower_daily.py:200} INFO - ADD  SEGMENT
[2024-07-29T14:31:51.072+0000] {motower_daily.py:205} INFO - DATA VALIDATION AFTER MERGING
[2024-07-29T14:31:51.072+0000] {data_validation.py:28} INFO - START VALIDATION 
[2024-07-29T14:31:51.073+0000] {data_validation.py:40} INFO - VALID ACTIFS SITES 3107
[2024-07-29T14:31:51.080+0000] {motower_daily.py:216} INFO - DAILY KPI -         jour       ca_voix      ca_data  parc_global  parc_data    parc_2g   parc_3g    parc_4g   parc_5g  autre_parc      ca_total
0 2024-06-02  4.705111e+08  699688383.6   14776871.0  8935471.0  3821885.0  122369.0  3167222.0  214239.0    447997.0  1.215856e+09
[2024-07-29T14:31:51.081+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_total
[2024-07-29T14:31:51.081+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_total ARE VALID
[2024-07-29T14:31:51.081+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_voix
[2024-07-29T14:31:51.082+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_voix ARE VALID
[2024-07-29T14:31:51.082+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN ca_data
[2024-07-29T14:31:51.083+0000] {data_validation.py:20} INFO - DATA OF COLUMN ca_data ARE VALID
[2024-07-29T14:31:51.083+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_global
[2024-07-29T14:31:51.083+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_global ARE VALID
[2024-07-29T14:31:51.084+0000] {data_validation.py:11} INFO - START VALIDATION OF COLUMN parc_data
[2024-07-29T14:31:51.084+0000] {data_validation.py:20} INFO - DATA OF COLUMN parc_data ARE VALID
[2024-07-29T14:31:51.107+0000] {logging_mixin.py:188} INFO -         jour code_oci  ...  previous_segment evolution_segment
0 2024-06-02  OCI2831  ...              None              None
1 2024-06-02  OCI3257  ...              None              None
2 2024-06-02  OCI3428  ...              None              None
3 2024-06-02  OCI2587  ...              None              None
4 2024-06-02  OCI3260  ...              None              None

[5 rows x 38 columns]
[2024-07-29T14:31:51.132+0000] {logging_mixin.py:188} INFO -         jour code_oci  ...  previous_segment evolution_segment
0 2024-06-02  OCI2831  ...              None              None
1 2024-06-02  OCI3257  ...              None              None
2 2024-06-02  OCI3428  ...              None              None
3 2024-06-02  OCI2587  ...              None              None
4 2024-06-02  OCI3260  ...              None              None

[5 rows x 38 columns]
[2024-07-29T14:31:51.143+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/custom_dags/motower_daily.py:139: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_faits['mois'] = data["jour"].dt.month

[2024-07-29T14:31:51.144+0000] {warnings.py:112} WARNING - /opt/***/dags/gps/custom_dags/motower_daily.py:140: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_faits['annee'] = data["jour"].dt.year

[2024-07-29T14:31:52.574+0000] {python.py:237} INFO - Done. Returned value was: None
[2024-07-29T14:31:52.576+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2024-07-29T14:31:52.588+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=motower_daily_prod, task_id=motower_dcaparc, run_id=scheduled__2024-06-03T06:00:00+00:00, execution_date=20240603T060000, start_date=20240729T143150, end_date=20240729T143152
[2024-07-29T14:31:52.650+0000] {local_task_job_runner.py:243} INFO - Task exited with return code 0
[2024-07-29T14:31:52.671+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-07-29T14:31:52.676+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
